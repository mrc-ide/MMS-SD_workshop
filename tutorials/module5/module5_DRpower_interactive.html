<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Malaria Molecular Surveillance Study Design workshop - Module 5: The DRpower tool</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Malaria Molecular Surveillance Study Design workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target=""><i class="bi bi-house" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html" rel="" target=""><i class="bi bi-calendar" role="img">
</i> 
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lectures.html" rel="" target=""><i class="bi bi-bookmark" role="img">
</i> 
 <span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../../tutorials.html" rel="" target="">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/module1_sampling_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/module2_MOE_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/module1_sampling_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/module1_sampling_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/module1_sampling_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/module6/module6_scenarios.html" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 6</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link" data-scroll-target="#learning-outcomes">Learning outcomes</a></li>
  </ul></li>
  <li><a href="#designing-a-multi-cluster-pfhrp23-deletion-study-in-ethiopia" id="toc-designing-a-multi-cluster-pfhrp23-deletion-study-in-ethiopia" class="nav-link" data-scroll-target="#designing-a-multi-cluster-pfhrp23-deletion-study-in-ethiopia">Designing a multi-cluster <em>pfhrp2/3</em> deletion study in Ethiopia</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#using-sample-size-tables" id="toc-using-sample-size-tables" class="nav-link" data-scroll-target="#using-sample-size-tables">Using sample size tables</a></li>
  <li><a href="#factoring-in-financial-considerations" id="toc-factoring-in-financial-considerations" class="nav-link" data-scroll-target="#factoring-in-financial-considerations">Factoring in financial considerations</a></li>
  <li><a href="#selecting-sites" id="toc-selecting-sites" class="nav-link" data-scroll-target="#selecting-sites">Selecting sites</a></li>
  <li><a href="#refining-sample-sizes" id="toc-refining-sample-sizes" class="nav-link" data-scroll-target="#refining-sample-sizes">Refining sample sizes</a></li>
  </ul></li>
  <li><a href="#analyzing-pfhrp23-data" id="toc-analyzing-pfhrp23-data" class="nav-link" data-scroll-target="#analyzing-pfhrp23-data">Analyzing <em>pfhrp2/3</em> data</a>
  <ul class="collapse">
  <li><a href="#estimating-the-icc" id="toc-estimating-the-icc" class="nav-link" data-scroll-target="#estimating-the-icc">Estimating the ICC</a></li>
  <li><a href="#recap-key-points" id="toc-recap-key-points" class="nav-link" data-scroll-target="#recap-key-points">Recap key points</a></li>
  </ul></li>
  <li><a href="#bonus-questions" id="toc-bonus-questions" class="nav-link" data-scroll-target="#bonus-questions">Bonus questions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Module 5: The DRpower tool</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome to Module 5: <strong>The DRpower tool</strong>.</p>
<p>In this module, we’ll demonstrate the use of the <strong>DRpower</strong> R package and the accompanying web-based tool.</p>
<section id="learning-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="learning-outcomes">Learning outcomes</h3>
<p>In this activity you will learn:</p>
<ul>
<li>How to design a multi-cluster <em>pfhrp2/3</em> deletion study.</li>
<li>How to analyse and interpret the results of a <em>pfhrp2/3</em> deletion study.</li>
<li>How to account for intra-cluster correlation in other study designs, such as prevalence surveys and presence/absence studies.</li>
</ul>
<p><em>Disclaimer: The scenarios in this document are entirely fictitious. While real place names are used, the data itself is simulated for teaching purposes only. It does not necessarily represent the real epidemiological situation.</em></p>
</section>
</section>
<section id="designing-a-multi-cluster-pfhrp23-deletion-study-in-ethiopia" class="level2">
<h2 class="anchored" data-anchor-id="designing-a-multi-cluster-pfhrp23-deletion-study-in-ethiopia">Designing a multi-cluster <em>pfhrp2/3</em> deletion study in Ethiopia</h2>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<p>You have been tasked by the Ethiopian National Malaria Control Programme (NMCP) to assist with design and implementation of a study into <em>pfhrp2/3</em> deletions. Following the WHO 2020 recommendation, this study will be multi-site and conducted at a regional level. It will establish whether the prevalence of <em>pfhrp2</em> deletions among clinical malaria cases is significantly above the 5% threshold. If so, this will trigger a nationwide switch in rapid diagnostic tests (RDTs) away from tests that rely exclusively on the HRP2 protein.</p>
<p>A full study of this sort would normally be run in parallel over multiple regions, however, for the purposes of this tutorial we will focus exclusively on the Amhara region.</p>
</section>
<section id="using-sample-size-tables" class="level3">
<h3 class="anchored" data-anchor-id="using-sample-size-tables">Using sample size tables</h3>
<p>First, we need to scope out roughly how many sites and how many samples are required. The easiest way to do this is via pre-calculated sample size tables. Go to the <em>pfhrp2/3</em> Planner and navigate to the <a href="https://shiny.dide.ic.ac.uk/DRpower-app/">Explore tab</a>.</p>
<p><img src="images/planner_explore_menu.png" class="img-fluid" style="width:100.0%"></p>
<p>You should see a sample size table with the number of sites (health facilities) in rows, and the assumed prevalence of <em>pfhrp2/3</em> deletions in columns (like below). The page automatically loads with the default ICC of <strong>0.05</strong> and the WHO <strong>5%</strong> prevalence threshold.</p>
<p><img src="images/explore_page.png" class="img-fluid" style="width:100.0%"></p>
<p>In any power analysis, we must begin by assuming a known effect size under the alternative hypothesis. For this study, that means selecting an assumed prevalence of <em>pfhrp2/3</em> deletions in the population. This assumption can be challenging and may feel somewhat arbitrary. It’s important to remember that as the assumed prevalence approaches the 5% detection threshold, the required sample size increases significantly. Conversely, assuming a very high prevalence may reduce the public health relevance of the study by focusing power on detecting only large shifts in the parasite population—changes that could already be affecting clinical diagnosis.</p>
<p>To balance these factors, we recommend a default assumed prevalence of 10% (highlighted in purple). This value provides a reasonable sensitivity level while keeping sample sizes manageable. For more insights on selecting this parameter, refer to the <a href="https://shiny.dide.ic.ac.uk/DRpower-app/">FAQ section</a> in the web-based <em>pfhrp2/3</em> Planner.</p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Sample sizes</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-sizes-10-1" class="tutorial-question panel-body">
<div id="quiz-sizes-10-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-sizes-10-1-message_container" class="shiny-html-output"></div>
<div id="quiz-sizes-10-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-sizes-10-2" class="tutorial-question panel-body">
<div id="quiz-sizes-10-2-answer_container" class="shiny-html-output"></div>
<div id="quiz-sizes-10-2-message_container" class="shiny-html-output"></div>
<div id="quiz-sizes-10-2-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>As the number of sites recruited increases, the total sample size needed actually decreases. This may seem counterintuitive, as we might expect that adding more clusters would inherently make the study larger. What’s happening here is that with more clusters, the samples become <em>more independent</em>. By sampling from a greater number of distinct sites, we reduce the likelihood of repeatedly sampling from the same sub-population, thereby minimizing the impact of intra-cluster correlation. As a result, fewer samples are needed overall to achieve the same level of statistical power.</p>
</section>
<section id="factoring-in-financial-considerations" class="level3">
<h3 class="anchored" data-anchor-id="factoring-in-financial-considerations">Factoring in financial considerations</h3>
<p>The Ethiopian NMCP has provided you with rough estimates of the costs of various aspects of the planned study, including the costs of RDT testing, microscopy, staff time, transport of samples and training of staff. They estimate it will cost $500 USD per health facility (cluster) recruited, plus an additional $6 USD per sample enrolled.</p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Sample sizes based on cost</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-sizes-cost-1" class="tutorial-question panel-body">
<div id="quiz-sizes-cost-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-sizes-cost-1-message_container" class="shiny-html-output"></div>
<div id="quiz-sizes-cost-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>The design with 7 clusters comes in at $6,365 UDS total. This is made up of $3,500 for setting up the clusters plus $2,856 for the samples enrolled. This is the cheapest of the possible options, although between 6 and 10 clusters are quite similar total costs and may also be viable options.</p>
</section>
<section id="selecting-sites" class="level3">
<h3 class="anchored" data-anchor-id="selecting-sites">Selecting sites</h3>
<p>Next, we have to choose how we will select the 7 sites. Common choices are 1) <em>sentinel site surveillance</em>, where known and established sites are chosen based on feasibility, and 2) <em>random selection</em>, where a complete list of all health facilities is compiled and a defined number of sites is drawn at random from this list.</p>
<p>Some advantages of sentinel site surveillance include:</p>
<ul>
<li><p><strong>Consistency and Comparability Over Time:</strong> Sentinel sites are typically chosen for long-term monitoring, enabling consistent data collection over time. This allows for more precise trend analysis and easier comparisons of changes in disease prevalence.</p></li>
<li><p><strong>Cost-Effectiveness and Established Infrastructure:</strong> Sentinel sites are often strategically chosen for accessibility and logistical ease, making them more cost-effective than random site selection, which may require travel to remote or difficult-to-reach locations. Additionally, these sites usually have established infrastructure, trained personnel, and local relationships, streamlining data collection and improving data quality.</p></li>
<li><p><strong>Targeting High-Burden or Priority Areas:</strong> Sentinel sites are often selected based on epidemiological significance, such as higher disease burden or strategic relevance for outbreak monitoring. This targeted approach can be advantageous in understanding and responding to disease patterns in high-risk areas, which might be overlooked in a random selection approach.</p></li>
</ul>
<p>On the other hand, there are some advantages of random site selection:</p>
<ul>
<li><p><strong>Improved Representativeness and Reduced Selection Bias:</strong> Random site selection from a complete list provides a more representative sample of the population and minimizes biases associated with known sentinel sites, which are often chosen based on specific criteria like accessibility or historical disease burden. This approach enhances the validity and generalizability of prevalence estimates, making them more applicable across various areas, including those not included in the survey.</p></li>
<li><p><strong>Greater Diversity of Environmental Conditions:</strong> Randomly selected sites are more likely to capture a range of environmental, socio-economic, and health system conditions. This variation is crucial for understanding factors that influence disease prevalence and for developing interventions that can apply across diverse settings.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Study design</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-design-1" class="tutorial-question panel-body">
<div id="quiz-design-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-design-1-message_container" class="shiny-html-output"></div>
<div id="quiz-design-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>For the sake of this tutorial we will go with random selection of sites. A complete list of all health facilities in the Amhara region is compiled, and 7 sites are selected from this list at random. <strong>Table 1</strong> gives the chosen sites and the target sample size based on our initial calculations.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Site name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Dese</td>
<td style="text-align: right; width: 4cm;">68</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 4cm;">Motta</td>
<td style="text-align: right; width: 4cm;">68</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Debark</td>
<td style="text-align: right; width: 4cm;">68</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 4cm;">Metema</td>
<td style="text-align: right; width: 4cm;">68</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Chagni</td>
<td style="text-align: right; width: 4cm;">68</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 4cm;">Finote Selam</td>
<td style="text-align: right; width: 4cm;">68</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Alem Ketema</td>
<td style="text-align: right; width: 4cm;">68</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup><br>
Table 1: target sample sizes based on initial exploration</td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</section>
<section id="refining-sample-sizes" class="level3">
<h3 class="anchored" data-anchor-id="refining-sample-sizes">Refining sample sizes</h3>
<p>With a preliminary study plan in place, we can now incorporate some real-world constraints. After discussions with site leads at each of the seven locations, we’ve learned that several sites may face challenges in reaching the target sample size. This could stem from factors like limited staffing, low malaria incidence, or other local issues. To address this, you’ve adjusted the sample sizes by increasing recruitment targets at sites where it is feasible to do so. Here’s the updated sample size table:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Site name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Dese</td>
<td style="text-align: right; width: 4cm;">100</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 4cm;">Motta</td>
<td style="text-align: right; width: 4cm;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Debark</td>
<td style="text-align: right; width: 4cm;">70</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 4cm;">Metema</td>
<td style="text-align: right; width: 4cm;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Chagni</td>
<td style="text-align: right; width: 4cm;">90</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 4cm;">Finote Selam</td>
<td style="text-align: right; width: 4cm;">70</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 4cm;">Alem Ketema</td>
<td style="text-align: right; width: 4cm;">60</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup><br>
Table 2: target sample sizes factoring in constraints</td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
<p>But now we are faced with a problem - how do we know if this new design still has adequate power? We can no longer rely on sample size tables, which assume the same sample size per cluster. On the other hand, we cannot simply <em>assume</em> that power will be adequate. This is where the <a href="https://shiny.dide.ic.ac.uk/DRpower-app/">Design tab</a> of the <em>pfhrp2/3</em> Planner becomes useful.</p>
<p>Download a .csv file with the current study plan <a href="https://raw.githubusercontent.com/mrc-ide/MMS-SD_workshop/refs/heads/main/tutorials/module5/data/pfhrp2_design.csv">from here</a>. You can then upload this spreadsheet into the we app using the “Upload a .csv file” option. You should find that the table populates with these values.</p>
<p><img src="images/design_upload.png" class="img-fluid" style="width:100.0%"></p>
<p>You’ll notice that drop-out is also considered at this stage. We are assuming 10% drop-out in each site, but for a more rigorous approach you may want to factor in different drop-out levels by site. When you click “Calculate adjusted sample sizes” you should see a table that contains the adjusted sample size, buffered for drop-out.</p>
<p>Now we are ready to estimate power. On the same page you will find drop-down menus where you can set the assumed prevalence of <em>pfhrp2/3</em> deletions and the intra-cluster correlation. When you hit the “Estimate power” button the tool will run a simulation-based power analysis (this may take a few seconds).</p>
<p><img src="images/est_power.png" class="img-fluid" style="width:100.0%"></p>
<p>Because this result is simulation-based we only get an <em>estimate</em> of the power, and not an exact figure. If you want a more precise estimate you can try increasing the number of simulations, although this will take longer to run.</p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Estimated power</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-power-1" class="tutorial-question panel-body">
<div id="quiz-power-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-power-1-message_container" class="shiny-html-output"></div>
<div id="quiz-power-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>Running an estimate with 1000 simulations should show that the study’s power is close to 80%, with the 95% confidence interval likely spanning this target. For future reference, you can download a copy of your power analysis from the “Generate report” tab. Based on these results, the study plan appears statistically sound and ready for consideration. However, final approval should also take into account logistical and financial factors to ensure feasibility.</p>
</section>
</section>
<section id="analyzing-pfhrp23-data" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-pfhrp23-data">Analyzing <em>pfhrp2/3</em> data</h2>
<p>Some time later, the Ethiopian NMCP request your assistance once again to analyse the results of the <em>pfhrp2/3</em> deletion study, which was carried out according to your plan. The results of the study are shown in <strong>Table 3</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Site name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pfhrp2 negative</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Dese</td>
<td style="text-align: right; width: 3cm;">10</td>
<td style="text-align: right; width: 3cm;">100</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3cm;">Motta</td>
<td style="text-align: right; width: 3cm;">1</td>
<td style="text-align: right; width: 3cm;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Debark</td>
<td style="text-align: right; width: 3cm;">9</td>
<td style="text-align: right; width: 3cm;">70</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3cm;">Metema</td>
<td style="text-align: right; width: 3cm;">7</td>
<td style="text-align: right; width: 3cm;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Chagni</td>
<td style="text-align: right; width: 3cm;">2</td>
<td style="text-align: right; width: 3cm;">90</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3cm;">Finote Selam</td>
<td style="text-align: right; width: 3cm;">2</td>
<td style="text-align: right; width: 3cm;">70</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Alem Ketema</td>
<td style="text-align: right; width: 3cm;">8</td>
<td style="text-align: right; width: 3cm;">60</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup><br>
Table 3: results of the pfhrp2/3 study</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
<p>You can download these results in .csv form <a href="https://github.com/mrc-ide/MMS-SD_workshop/blob/main/tutorials/module5/data/pfhrp2_results.csv">here</a>. The easiest way to analyse these data is via the <a href="https://shiny.dide.ic.ac.uk/DRpower-app/">Analysis tab</a> of the <em>pfhrp2/3</em> Planner. Select “Upload a .csv file” and import the data.</p>
<p><img src="images/analysis_upload.png" class="img-fluid" style="width:100.0%"></p>
<p>Now click the “Estimate prevalence” button to perform a Bayesian analysis of the data. This analysis takes into account the intra-cluster correlation in the data, which is estimated and accounted for in the prevalence estimate. Therefore there is no need to estimate a design effect or effective sample size as this is accounted for automatically.</p>
<p>You will also see a “Probability above threshold” field. This tells us the probability that the prevalence is above the 5% threshold.</p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Probability above threshold</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-prob-1" class="tutorial-question panel-body">
<div id="quiz-prob-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-prob-1-message_container" class="shiny-html-output"></div>
<div id="quiz-prob-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>In this example, we have sufficient evidence to conclude that the prevalence of <em>pfhrp2/3</em> deletions in the Amhara region is above the 5% threshold. Therefore, according to the WHO 2020 recommendation, we would be justified in switching RDTs to a brand that does not rely exclusively on the HRP2 protein.</p>
<section id="estimating-the-icc" class="level3">
<h3 class="anchored" data-anchor-id="estimating-the-icc">Estimating the ICC</h3>
<p>As noted above, the <strong>DRpower</strong> method automatically accounts for ICC when estimating prevalence, so a separate ICC estimate is not strictly necessary. However, obtaining an ICC estimate can still be valuable for future study planning. It’s a straightforward process and contributes to a broader understanding of ICC levels, which can benefit researchers planning similar studies in the future or in neighbouring regions.</p>
<p>Still on the <a href="https://shiny.dide.ic.ac.uk/DRpower-app/">Analysis tab</a>, scroll down to the “Estimate ICC” button (it should look like the screenshot below). Clicking this button gives an estimate of the ICC, including a point estimate and a 95% Credible Interval (CrI).</p>
<p><img src="images/est_icc.png" class="img-fluid" style="width:100.0%"></p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Intra-cluster correlation</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-icc-1" class="tutorial-question panel-body">
<div id="quiz-icc-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-icc-1-message_container" class="shiny-html-output"></div>
<div id="quiz-icc-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>We can navigate to the “Generate report” tab to download a report detailing our analysis.</p>
</section>
<section id="recap-key-points" class="level3">
<h3 class="anchored" data-anchor-id="recap-key-points">Recap key points</h3>
<p>Our <em>pfhrp2/3</em> analysis is now complete. We began with a well-powered study design, carefully crafted to be robust and realistic. By accounting for varying sample sizes across sites and anticipating potential drop-out, we reinforced the reliability of our approach. Beyond statistical considerations, we incorporated logistical and financial constraints to ensure the study’s feasibility. Importantly, we accounted for possible over-dispersion at both the design and analysis stages, increasing our confidence in the results. Ultimately, this rigorous approach allows us to conclude with confidence that the prevalence of <em>pfhrp2/3</em> deletions exceeds the 5% threshold—a finding with significant implications for malaria control at the national level.</p>
</section>
</section>
<section id="bonus-questions" class="level2">
<h2 class="anchored" data-anchor-id="bonus-questions">Bonus questions</h2>
<p>The <strong>DRpower</strong> R package is primarily designed with <em>pfhrp2/3</em> studies in mind, but also contains some functions that are useful for other multi-cluster designs. For example, it can be used when estimating prevalence to within a specified margin of error, or when detecting the presence of rare variants, while taking into account intra-cluster correlation. These features are only present in the R package, and are not present on the web-based <em>pfhrp2/3</em> Planner.</p>
<p>The following R code calculates the sample size needed for a multi-cluster prevalence survey to reach a target margin of error. Try varying the value of the ICC and see how this impacts sample size.</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="moe-calc" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sample size needed to achieve a target MOE</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>DRpower<span class="sc">::</span><span class="fu">get_sample_size_margin</span>(<span class="at">MOE =</span> <span class="fl">0.1</span>, <span class="at">n_clust =</span> <span class="dv">10</span>, <span class="at">prevalence =</span> <span class="fl">0.2</span>, <span class="at">ICC =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<p>The result you obtain is the sample size needed per cluster to achieve your target MOE using the Wald interval.</p>
<p>Until now, we have focused on using the Wald interval to construct a 95% confidence interval (CI). Although the Wald interval is straightforward to calculate, it relies on assumptions that may not always hold. For instance, with a small sample size or when prevalence is near 0 or 1, the Wald interval can extend beyond logical boundaries, producing values below 0 or above 1. Such results are nonsensical and indicate that the interval may not accurately represent the underlying data.</p>
<p>An alternative approach is to use the Clopper-Pearson (CP) interval. Unlike the Wald interval, the CP interval remains within the 0 to 1 range, making it more statistically robust. However, this robustness comes with a trade-off: the CP interval tends to be conservative, resulting in wider intervals.</p>
<p>Play around with the following R code, which still aims to reach a target margin of error but now assuming CP intervals.</p>
<div style="padding: 10px; border-radius: 5px; background-color: #fef3e7;">
<p><span style="font-size: 1.2em; color: #d19554;"> <i class="fas fa-comment"></i> Reflection: </span></p>
<p><span style="color:#d19554;"> What do you notice about the sample size compared to the simple Wald interval approach? </span></p>
</div>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="moe-cp" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sample size needed to achieve a target MOE using CP intervals</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>DRpower<span class="sc">::</span><span class="fu">get_sample_size_margin_CP</span>(<span class="at">MOE =</span> <span class="fl">0.1</span>, <span class="at">n_clust =</span> <span class="dv">10</span>, <span class="at">prevalence =</span> <span class="fl">0.2</span>, <span class="at">ICC =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<p>The result you obtain is the sample size needed per cluster to achieve your target MOE using the CP interval.</p>
<p>Finally, we may want to look for the presence of rare variants in a multi-cluster design while accounting for intra-cluster correlation.</p>
<p>Play around with the following code.</p>
<div style="padding: 10px; border-radius: 5px; background-color: #fef3e7;">
<p><span style="font-size: 1.2em; color: #d19554;"> <i class="fas fa-comment"></i> Reflection: </span></p>
<p><span style="color:#d19554;"> What total sample size would you need if you assume 10 clusters, 1% prevalence of the variant of interest, and an ICC of 0.05? How would this compare to the total sample size if you treated all sites as independent? </span></p>
</div>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="cluster-sizes" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate sample size needed in a multi-cluster presence/absence study</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>DRpower<span class="sc">::</span><span class="fu">get_sample_size_presence</span>(<span class="at">n_clust =</span> <span class="dv">5</span>, <span class="at">prevalence =</span> <span class="fl">0.05</span>, <span class="at">ICC =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<p>The result you obtain is the sample size needed per cluster to detect the presence of rare variants at 1% prevalence. 
<script type="application/shiny-prerendered" data-context="server-start">
# options(repos = c(
#   plasmogenepi = "https://plasmogenepi.r-universe.dev",
#   CRAN = "https://cloud.r-project.org"
# ))

library(learnr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(knitr)
library(kableExtra)
library(DRpower)

knitr::opts_chunk$set(warning = FALSE,
                      echo = FALSE)

# needed for longer calculations (eg DRpower) note - in seconds
tutorial_options(exercise.timelimit = 120)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::prepare_tutorial_state(session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::i18n_observe_tutorial_language(input, session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-sizes-10-1", 
    question = structure("What is the <em>total<\u002fem> sample size needed (over all clusters) if we recruit 5 clusters?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_afecbc", 
        option = "2480", value = "2480", label = structure("2480", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_c5c2860", 
        option = "678", value = "678", label = structure("678", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_e078258", 
        option = "408", value = "408", label = structure("408", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_1127467", 
        option = "300", value = "300", label = structure("300", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-sizes-10-1-answer", question = "quiz-sizes-10-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 89335683.9583998, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-sizes-10-2", 
    question = structure("What about if we recruit 10 clusters?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_78d53b1", 
        option = "2480", value = "2480", label = structure("2480", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_d7649c9", 
        option = "678", value = "678", label = structure("678", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_f1325d3", 
        option = "408", value = "408", label = structure("408", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_d254bbf", 
        option = "300", value = "300", label = structure("300", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-sizes-10-2-answer", question = "quiz-sizes-10-2"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1928181433.10212, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-sizes-cost-1", 
    question = structure("Based on these financial figures, and using the numbers from the sample size table, how many clusters should you recruit to minimize the total cost?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_d0a0103", 
        option = "2", value = "2", label = structure("2", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_4f5b5ec", 
        option = "5", value = "5", label = structure("5", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_4a4019c", 
        option = "7", value = "7", label = structure("7", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_5b41185", 
        option = "10", value = "10", label = structure("10", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-sizes-cost-1-answer", question = "quiz-sizes-cost-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 2079869975.03149, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_checkbox", label = "quiz-design-1", 
    question = structure("Which of these designs would you choose for this study?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_514afcc", 
        option = "Sentinel site surveillance ", value = "Sentinel site surveillance ", 
        label = structure("Sentinel site surveillance", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_9c49522", 
        option = "Random sampling", value = "Random sampling", 
        label = structure("Random sampling", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect. Be sure to select every correct answer.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-design-1-answer", question = "quiz-design-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 796630095.12904, options = list()), class = c("learnr_checkbox", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-power-1", 
    question = structure("Do you think power is adequate under the current plan?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_f99a54d", 
        option = "Yes", value = "Yes", label = structure("Yes", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_f6fe9db", 
        option = "No", value = "No", label = structure("No", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-power-1-answer", question = "quiz-power-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1848837345.63907, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_checkbox", label = "quiz-prob-1", 
    question = structure("Which of these is true?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_758d5b8", 
        option = "There is *less than 95% probability* that the prevalence is above the 5% threshold. Therefore we conclude that the prevalence is below 5%.", 
        value = "There is *less than 95% probability* that the prevalence is above the 5% threshold. Therefore we conclude that the prevalence is below 5%.", 
        label = structure("There is <em>less than 95% probability<\u002fem> that the prevalence is above the 5% threshold. Therefore we conclude that the prevalence is below 5%.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_802d5b7", 
        option = "There is *more than 95% probability* that the prevalence is above the 5% threshold. Therefore we conclude that the prevalence is above 5%.", 
        value = "There is *more than 95% probability* that the prevalence is above the 5% threshold. Therefore we conclude that the prevalence is above 5%.", 
        label = structure("There is <em>more than 95% probability<\u002fem> that the prevalence is above the 5% threshold. Therefore we conclude that the prevalence is above 5%.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect. Be sure to select every correct answer.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-prob-1-answer", question = "quiz-prob-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 651967857.696404, options = list()), class = c("learnr_checkbox", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_checkbox", label = "quiz-icc-1", 
    question = structure("Based on the ICC analysis, which of these is true:", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_2119caa", 
        option = "There is strong evidence that the ICC is below 0.2", 
        value = "There is strong evidence that the ICC is below 0.2", 
        label = structure("There is strong evidence that the ICC is below 0.2", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_7a23bb6", 
        option = "There is strong evidence that the ICC is below 0.1", 
        value = "There is strong evidence that the ICC is below 0.1", 
        label = structure("There is strong evidence that the ICC is below 0.1", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_8461f3a", 
        option = "There is strong evidence that the ICC is below 0.05", 
        value = "There is strong evidence that the ICC is below 0.05", 
        label = structure("There is strong evidence that the ICC is below 0.05", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_20ceb3d", 
        option = "There is strong evidence that the ICC is zero (complete independence)", 
        value = "There is strong evidence that the ICC is zero (complete independence)", 
        label = structure("There is strong evidence that the ICC is zero (complete independence)", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect. Be sure to select every correct answer.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-icc-1-answer", question = "quiz-icc-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 375695083.825053, options = list()), class = c("learnr_checkbox", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-moe-calc-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-moe-calc-code-editor`)), session)
output$`tutorial-exercise-moe-calc-output` <- renderUI({
  `tutorial-exercise-moe-calc-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "moe-calc", global_setup = structure(c("# options(repos = c(", 
"#   plasmogenepi = \"https://plasmogenepi.r-universe.dev\",", 
"#   CRAN = \"https://cloud.r-project.org\"", "# ))", "", "library(learnr)", 
"library(dplyr)", "library(ggplot2)", "library(tidyr)", "library(knitr)", 
"library(kableExtra)", "library(DRpower)", "", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "moe-calc", code = "# calculate sample size needed to achieve a target MOE\nDRpower::get_sample_size_margin(MOE = 0.1, n_clust = 10, prevalence = 0.2, ICC = 0.01)", 
        opts = list(label = "\"moe-calc\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = NULL, tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "module5_DRpower_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "module5_DRpower_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "moe-calc", exercise = TRUE, original.params.src = "r moe-calc, exercise = TRUE", 
        chunk.echo = FALSE, code = c("# calculate sample size needed to achieve a target MOE", 
        "DRpower::get_sample_size_margin(MOE = 0.1, n_clust = 10, prevalence = 0.2, ICC = 0.01)"
        ), out.width.px = 672L, out.height.px = 480L, params.src = "r moe-calc, exercise = TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-moe-cp-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-moe-cp-code-editor`)), session)
output$`tutorial-exercise-moe-cp-output` <- renderUI({
  `tutorial-exercise-moe-cp-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "moe-cp", global_setup = structure(c("# options(repos = c(", 
"#   plasmogenepi = \"https://plasmogenepi.r-universe.dev\",", 
"#   CRAN = \"https://cloud.r-project.org\"", "# ))", "", "library(learnr)", 
"library(dplyr)", "library(ggplot2)", "library(tidyr)", "library(knitr)", 
"library(kableExtra)", "library(DRpower)", "", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "moe-cp", code = "# calculate sample size needed to achieve a target MOE using CP intervals\nDRpower::get_sample_size_margin_CP(MOE = 0.1, n_clust = 10, prevalence = 0.2, ICC = 0.01)", 
        opts = list(label = "\"moe-cp\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = NULL, tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "module5_DRpower_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "module5_DRpower_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "moe-cp", exercise = TRUE, original.params.src = "r moe-cp, exercise = TRUE", 
        chunk.echo = FALSE, code = c("# calculate sample size needed to achieve a target MOE using CP intervals", 
        "DRpower::get_sample_size_margin_CP(MOE = 0.1, n_clust = 10, prevalence = 0.2, ICC = 0.01)"
        ), out.width.px = 672L, out.height.px = 480L, params.src = "r moe-cp, exercise = TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-cluster-sizes-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-cluster-sizes-code-editor`)), session)
output$`tutorial-exercise-cluster-sizes-output` <- renderUI({
  `tutorial-exercise-cluster-sizes-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "cluster-sizes", global_setup = structure(c("# options(repos = c(", 
"#   plasmogenepi = \"https://plasmogenepi.r-universe.dev\",", 
"#   CRAN = \"https://cloud.r-project.org\"", "# ))", "", "library(learnr)", 
"library(dplyr)", "library(ggplot2)", "library(tidyr)", "library(knitr)", 
"library(kableExtra)", "library(DRpower)", "", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "cluster-sizes", code = "# calculate sample size needed in a multi-cluster presence/absence study\nDRpower::get_sample_size_presence(n_clust = 5, prevalence = 0.05, ICC = 0.05)", 
        opts = list(label = "\"cluster-sizes\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = NULL, tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "module5_DRpower_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "module5_DRpower_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "cluster-sizes", exercise = TRUE, original.params.src = "r cluster-sizes, exercise = TRUE", 
        chunk.echo = FALSE, code = c("# calculate sample size needed in a multi-cluster presence/absence study", 
        "DRpower::get_sample_size_presence(n_clust = 5, prevalence = 0.05, ICC = 0.05)"
        ), out.width.px = 672L, out.height.px = 480L, params.src = "r cluster-sizes, exercise = TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["5.5.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.5.9000"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74]}},"value":[{"type":"character","attributes":{},"value":["backports","base","checkmate","cli","colorspace","commonmark","compiler","datasets","digest","dplyr","DRpower","evaluate","extraDistr","fansi","fastmap","fontawesome","generics","ggplot2","glue","graphics","grDevices","grid","gtable","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","kableExtra","knitr","knitrProgressBar","later","learnr","lifecycle","magrittr","markdown","methods","mime","munsell","pillar","pkgconfig","promises","purrr","R.methodsS3","R.oo","R6","Rcpp","rlang","rmarkdown","rprojroot","rstudioapi","rvest","scales","shiny","stats","stringi","stringr","svglite","systemfonts","tibble","tidyr","tidyselect","tools","utf8","utils","vctrs","viridisLite","webshot","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.5.0","4.3.1","2.3.2","3.6.3","2.1-1","1.9.2","4.3.1","4.3.1","0.6.37","1.1.4","1.0.3","1.0.0","1.10.0","1.0.6","1.2.0","0.5.2","0.1.3","3.5.1","1.8.0","4.3.1","4.3.1","4.3.1","0.3.6","0.5.8.1","1.6.4","1.6.15","1.4.7","0.1.4","1.8.9","1.3.4","1.48","1.1.1","1.3.2","0.11.5.9000","1.0.4","2.0.3","1.13","4.3.1","0.12","0.5.1","1.9.0","2.0.3","1.3.0","1.0.2","1.8.2","1.27.0","2.5.1","1.0.13-1","1.1.4","2.28","2.0.4","0.16.0","1.0.3","1.3.0","1.9.1","4.3.1","1.8.4","1.5.1","2.1.3","1.0.6","3.2.1","1.3.1","1.2.1","4.3.1","1.2.4","4.3.1","0.6.5","0.4.2","0.5.5","3.0.2","0.48","1.3.6","1.8-4","2.3.10"]}]}]}
</script>
<!--/html_preserve-->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>