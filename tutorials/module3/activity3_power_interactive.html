<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Malaria Molecular Surveillance Study Design workshop - Activity 3: Hypothesis Testing and Power</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Malaria Molecular Surveillance Study Design workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target=""><i class="bi bi-house" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html" rel="" target=""><i class="bi bi-calendar" role="img">
</i> 
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lectures.html" rel="" target=""><i class="bi bi-bookmark" role="img">
</i> 
 <span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../../tutorials.html" rel="" target="">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/module1_sampling_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/activity2_MOE_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/activity3_power_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/activity4_multicluster_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mms-sdworkshop.shinyapps.io/module5_DRpower_interactive/" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/module6/module6_scenarios.html" rel="" target=""><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Module 6</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  </ul></li>
  <li><a href="#quiz-on-hypothesis-testing-and-power" id="toc-quiz-on-hypothesis-testing-and-power" class="nav-link" data-scroll-target="#quiz-on-hypothesis-testing-and-power">Quiz on hypothesis testing and power</a></li>
  <li><a href="#testing-for-changes-in-drug-resistance-prevalence-over-time" id="toc-testing-for-changes-in-drug-resistance-prevalence-over-time" class="nav-link" data-scroll-target="#testing-for-changes-in-drug-resistance-prevalence-over-time">Testing for changes in drug resistance prevalence over time</a></li>
  <li><a href="#using-power-curves" id="toc-using-power-curves" class="nav-link" data-scroll-target="#using-power-curves">Using power curves</a></li>
  <li><a href="#using-sample-size-tables" id="toc-using-sample-size-tables" class="nav-link" data-scroll-target="#using-sample-size-tables">Using sample size tables</a></li>
  <li><a href="#detecting-rare-variants" id="toc-detecting-rare-variants" class="nav-link" data-scroll-target="#detecting-rare-variants">Detecting rare variants</a>
  <ul class="collapse">
  <li><a href="#framing-the-problem-as-a-hypothesis-test" id="toc-framing-the-problem-as-a-hypothesis-test" class="nav-link" data-scroll-target="#framing-the-problem-as-a-hypothesis-test">Framing the problem as a hypothesis test</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Activity 3: Hypothesis Testing and Power</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome to Activity 3: <strong>Hypothesis Testing and Power</strong></p>
<p>In this activity, we introduce the concept of statistical power and demonstrate its connection to null hypothesis testing. In many studies within malaria molecular surveillance, we aim to test specific hypotheses. For instance: Has the prevalence of drug resistance mutations increased over the past five years? Are certain genetic variants linked to gender, or occupation? Does treatment efficacy vary based on genetic markers? Each of these questions can be framed as a null hypothesis test. This leads us to a crucial question: given that a real effect exists, how likely are we to detect it? Statistical power is the mathematical way to calculate how likely we are to detect this real effect. We’ll explore these concepts using two examples: comparing drug resistance prevalence against a known value and detecting rare genetic variants</p>
<section id="learning-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h3>
<p>By the end of this tutorial, you will be able to:</p>
<ul>
<li>Define key terms related to null hypothesis testing.</li>
<li>Use a test statistic to decide whether or not to reject a null hypothesis.</li>
<li>Perform power analysis using two different statistical tests.</li>
<li>Interpret power curves.</li>
<li>Use minimum sample size tables.</li>
</ul>
<p><em>Disclaimer: The scenarios in this document are entirely fictitious. While real place names are used, the data itself is artificial and designed for teaching purposes only. It does not necessarily represent the real epidemiological situation in these locations.</em></p>
</section>
</section>
<section id="quiz-on-hypothesis-testing-and-power" class="level2">
<h2 class="anchored" data-anchor-id="quiz-on-hypothesis-testing-and-power">Quiz on hypothesis testing and power</h2>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title"></div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-q1-1" class="tutorial-question panel-body">
<div id="quiz-q1-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-q1-1-message_container" class="shiny-html-output"></div>
<div id="quiz-q1-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-q1-2" class="tutorial-question panel-body">
<div id="quiz-q1-2-answer_container" class="shiny-html-output"></div>
<div id="quiz-q1-2-message_container" class="shiny-html-output"></div>
<div id="quiz-q1-2-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-q1-3" class="tutorial-question panel-body">
<div id="quiz-q1-3-answer_container" class="shiny-html-output"></div>
<div id="quiz-q1-3-message_container" class="shiny-html-output"></div>
<div id="quiz-q1-3-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-q1-4" class="tutorial-question panel-body">
<div id="quiz-q1-4-answer_container" class="shiny-html-output"></div>
<div id="quiz-q1-4-message_container" class="shiny-html-output"></div>
<div id="quiz-q1-4-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-q1-5" class="tutorial-question panel-body">
<div id="quiz-q1-5-answer_container" class="shiny-html-output"></div>
<div id="quiz-q1-5-message_container" class="shiny-html-output"></div>
<div id="quiz-q1-5-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-q1-6" class="tutorial-question panel-body">
<div id="quiz-q1-6-answer_container" class="shiny-html-output"></div>
<div id="quiz-q1-6-message_container" class="shiny-html-output"></div>
<div id="quiz-q1-6-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-q1-7" class="tutorial-question panel-body">
<div id="quiz-q1-7-answer_container" class="shiny-html-output"></div>
<div id="quiz-q1-7-message_container" class="shiny-html-output"></div>
<div id="quiz-q1-7-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>Well done on completing this quiz! We will now put some of these ideas into practice.</p>
</section>
<section id="testing-for-changes-in-drug-resistance-prevalence-over-time" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-changes-in-drug-resistance-prevalence-over-time">Testing for changes in drug resistance prevalence over time</h2>
<p>You are a local health minister working in the Gombe region of Nigeria. You are concerned that the prevalence of antimalarial resistance may be increasing in Gombe city, the capital of Gombe state. A study conducted three years ago found that the prevalence of <em>pfmdr1</em> N86Y mutations was 15%. You plan to conduct a new study to establish if there has been a significant change in the prevalence of N86Y mutations over this time.</p>
<p>To simplify our analysis, we will take the previous estimate of 15% prevalence three years ago to be exact. This means we are comparing a sample against a known value, in which case the appropriate statistical test is the one-sample z-test for proportions.</p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title"></div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="ztest-quiz-1" class="tutorial-question panel-body">
<div id="ztest-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="ztest-quiz-1-message_container" class="shiny-html-output"></div>
<div id="ztest-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>We will denote the prevalence three years ago by <span class="math inline">\(p_0 = 0.15\)</span>. For our power analysis, we need to assume a known prevalence in the present day, which we will denote <span class="math inline">\(p\)</span>. We will be pessimistic and assume that the prevalence has doubled over the three year period, meaning <span class="math inline">\(p=0.30\)</span>. Our initial plan is to use a sample size of <span class="math inline">\(n=150\)</span>.</p>
<p>Given these values, we can calculate the <em>expected value</em> for our test statistic using the following formula: <span class="math display">\[
E[Z] = \frac{|p - p_0|}{\sqrt{\frac{p(1-p)}{n}}}
\]</span> The vertical lines around <span class="math inline">\(|p - p_0|\)</span> mean we should take the <em>absolute value</em> of the difference. This ensures that <span class="math inline">\(E[Z]\)</span> is always positive.</p>
<p>Complete the following R code to calculate the value of <span class="math inline">\(E[Z]\)</span>:</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="ztest-1" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input parameters</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate absolute value of difference in prevalence</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>p_diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(p <span class="sc">-</span> p0)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the standard error</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> n)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the expected value of the statistic</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>E_Z <span class="ot">&lt;-</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(E_Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="ztest-1-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input parameters</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate absolute value of difference in prevalence</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>p_diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(p <span class="sc">-</span> p0)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the standard error</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> n)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the expected value of the statistic</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>E_Z <span class="ot">&lt;-</span> p_diff <span class="sc">/</span> SE</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(E_Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(E[Z}] = 4.01\)</span>.</p>
</details>
<p><br></p>
<p>This means that <em>on average</em> we should expect our test statistic to equal <span class="math inline">\(4.01\)</span>, assuming the alternative hypothesis is true. The actual value that we observe will vary around this value.</p>
<p>We can use <span class="math inline">\(E[Z]\)</span> to tell us our power. The formula for power under the z-test is:</p>
<p><span class="math display">\[
\text{Power} = 1 - \phi(z_{1-\alpha/2} - E[Z])
\]</span></p>
<p>In this formula, <span class="math inline">\(\phi(x)\)</span> refers to the area under the curve of a standard normal distribution up to the point <span class="math inline">\(x\)</span>. There is no simple way of calculating this value, but we can obtain it easily in R using the <code>pnorm()</code> function. As in previous activities, the value <span class="math inline">\(z_{1 - \alpha/2}\)</span> refers to the critical value of the normal distribution at a significance level <span class="math inline">\(\alpha\)</span> (two-tailed), which is approximately equal to 1.96.</p>
<p>Complete the following R code to calculate the power under the planned study design. You still have access to the variable <code>E_Z</code> from before in this code chunk:</p>
<div class="cell" data-exercise="true" data-exercise.setup="ztest-2-params">
<div class="tutorial-exercise" data-label="ztest-2" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power using the known value of E_Z</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="ot">&lt;-</span> <span class="fl">1.96</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="co"># hint, you will need to use the pnorm() function here</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="ztest-2-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power using the known value of E_Z</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="ot">&lt;-</span> <span class="fl">1.96</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z_alpha <span class="sc">-</span> E_Z)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(\text{Power} = 0.98\)</span>.</p>
</details>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title"></div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="power-quiz-1" class="tutorial-question panel-body">
<div id="power-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="power-quiz-1-message_container" class="shiny-html-output"></div>
<div id="power-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
</section>
<section id="using-power-curves" class="level2">
<h2 class="anchored" data-anchor-id="using-power-curves">Using power curves</h2>
<p>We have calculated that our current study design has 98% power. We normally aim for at least 80% power, meaning this study is adequately powered. In fact, we could argue that it is <em>over-powered</em>, meaning we could get away with using fewer samples and still have a good chance of detecting a real effect.</p>
<p>We can use power curves to explore how power changes as a function of sample size. In the plot below, the region with at least 80% power is shaded in blue.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="activity3_power_interactive_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title"></div>
</div>
<div class="cell-output-display">
<div class="panel panel-default tutorial-question-container">
<div data-label="power-curve-quiz-1" class="tutorial-question panel-body">
<div id="power-curve-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="power-curve-quiz-1-message_container" class="shiny-html-output"></div>
<div id="power-curve-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>The power analysis indicates that we may not need to sequence 150 samples after all. However, it did make the rather pessimistic assumption that prevalence has doubled from 15% to 30% over the three year period. It would be useful to repeat this analysis making different assumptions about the prevalence. One way to do this is via a series of power curves:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="activity3_power_interactive_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>Even a slight change in our assumption about the prevalence of N86Y mutations has a large effect on power. If we assumed present-day prevalence was 25% rather than 30% then we would need twice as many samples to achieve 80% power. This analysis was useful for exploring the exact relationship between sample size and power. However, it can be fiddly to read values off the power curve to find the exact point at which it crosses the 80% threshold. This is where sample size formulae and sample size tables come in handy.</p>
</section>
<section id="using-sample-size-tables" class="level2">
<h2 class="anchored" data-anchor-id="using-sample-size-tables">Using sample size tables</h2>
<p>Recall that power under the one-sample z-test for proportions was given by <span class="math display">\[
\text{Power} = 1 - \phi\left(z_{1-\alpha/2} - \frac{|p - p_0|}{\sqrt{\frac{p(1 - p)}{n}}} \right)
\]</span> In an earlier module we rearranged the formula for the Wald confidence interval to arrive at a new formula in terms of the sample size <span class="math inline">\(n\)</span>. Here, we want to do exactly the same thing, just with a more complicated formula! We won’t walk through the steps of this derivation, but take my word for it that this can be rearranged to produce: <span class="math display">\[
n = (z_{1 - \alpha/2} + z_{1 - \beta})^2\frac{p(1 - p)}{(p - p_0)^2}
\]</span> The only unfamiliar term here is <span class="math inline">\(z_{1 - \beta}\)</span>, which is the area under the curve of the standard normal distribution up to the value <span class="math inline">\(1 - \beta\)</span>. The parameter <span class="math inline">\(\beta\)</span> is one minus our power. Typically <span class="math inline">\(\beta = 0.2\)</span> because target power is usually 0.8.</p>
<p>The following R code implements this sample size formula. Have a play around with this code. Try changing the value of <code>p</code> and see what happens to the minimum sample size. Do you obtain the value <span class="math inline">\(n=74\)</span> when <span class="math inline">\(p=0.3\)</span>, like we found from the power curve? Remember that you should always round sample sizes <em>up</em> if they are non-integers. What happens to the sample size as <code>p</code> gets closer to the 15% threshold?</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="ztest-ss-2" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define our assumed values</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.30</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define the two z parameters</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="ot">&lt;-</span> <span class="fl">1.96</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>z_beta <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.8</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the minimum sample size</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>(z_alpha <span class="sc">+</span> z_beta)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> p<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> (p <span class="sc">-</span> p0)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<p>One of the nice things about sample size formulae is that we can use them to produce tables of minimum sample sizes. <strong>Table 1</strong> shows the minimum sample size required to achieve 80% power under different assumptions about the prevalence of N86Y mutations:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Assumed present-day prevalence of N86Y mutation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 6cm;">20%</td>
<td style="text-align: right; width: 4cm;">503</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;">25%</td>
<td style="text-align: right; width: 4cm;">148</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;">30%</td>
<td style="text-align: right; width: 4cm;">74</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;">35%</td>
<td style="text-align: right; width: 4cm;">45</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;">40%</td>
<td style="text-align: right; width: 4cm;">31</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;">45%</td>
<td style="text-align: right; width: 4cm;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;">50%</td>
<td style="text-align: right; width: 4cm;">17</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup><br>
Table 1: minimum sample sizes under various assumptions about present-day prevalence</td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
<p>This allows us to scan across values and work out what is reasonable, and also what is achievable.</p>
<div style="padding: 10px; border-radius: 5px; background-color: #fef3e7;">
<p><span style="font-size: 1.2em; color: #d19554;"> <i class="fas fa-comment"></i> Reflection: </span></p>
<p><span style="color:#d19554;"> What sample size would you opt for in this case? What factors could help you decide on a reasonable assumption for the present day prevalence of N86Y mutations? What factors could help constrain which sample sizes are feasible? </span></p>
</div>
</section>
<section id="detecting-rare-variants" class="level2">
<h2 class="anchored" data-anchor-id="detecting-rare-variants">Detecting rare variants</h2>
<p>Building on the success of your N86Y study in Gombe city, you have been invited to conduct a new study focused on identifying <em>pfk13</em> mutations in the nearby town of Pindiga. This study will target WHO validated mutations that are known to be associated with partial resistance to artemisinin. Instead of estimating the <em>prevalence</em> of these mutations, your goal is simply to determine whether any of these mutations are <em>present</em> in the population.</p>
<p>You will test individuals who present with malaria symptoms at a local health facility. For those who test positive for malaria, dried blood spots will be collected and subsequently sent for sequencing. However, due to limited resources, you are only able to sequence 100 samples.</p>
<p>The key question, then, is: <strong>with a sample size of only 100, is it worthwhile to pursue this study?</strong></p>
<section id="framing-the-problem-as-a-hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="framing-the-problem-as-a-hypothesis-test">Framing the problem as a hypothesis test</h3>
<p>This type of detection study can be framed as a null hypothesis test. The null hypothesis is that <em>there are no WHO-validated mutations present in the population</em>. In other words, the prevalence of these mutations is zero. Even a single observation of a WHO-validated mutant would disprove this null hypothesis. Therefore, unlike most statistical tests, there is no test statistic to calculate here. Instead, we simply reject the null hypothesis if we see a single sample containing a WHO-validated mutant.</p>
<p>It is straightforward to calculate power under this test. We start by assuming a known prevalence, <span class="math inline">\(p\)</span>, for the validated mutations. We can derive the power by following these steps:</p>
<p><strong>Step 1: Chance of a single negative result:</strong></p>
<p>The probability that a single sample is negative (i.e.&nbsp;does not carry a validated <em>pfk13</em> mutation) is given by: <span class="math display">\[
\text{Pr}(\text{Negative}) = 1 - p
\]</span> <strong>Step 2: Chance of two negative results:</strong></p>
<p>The probability of two negative samples is the probability of one negative sample multiplied by the probability of another negative sample: <span class="math display">\[
\begin{align}
\text{Pr}(\text{Two negatives}) &amp;= (1 - p)(1 - p) \\
&amp;= (1 - p)^2
\end{align}
\]</span></p>
<p><strong>Step 3: Chance of <span class="math inline">\(n\)</span> negative results:</strong></p>
<p>The probability that all <span class="math inline">\(n\)</span> samples are negative is the probability of one negative sample raised to the power <span class="math inline">\(n\)</span>: <span class="math display">\[
\text{Pr}(n \text{ negatives}) = (1 - p)^n
\]</span> This is like saying what is the probability we observe a negative outcome <span class="math inline">\(n\)</span> times. It assumes that samples are drawn independently from a much larger population.</p>
<p><strong>Step 4: Chance of at least one positive result:</strong></p>
<p>The chance of seeing at least one positive sample is equal to one minus the probability of seeing no positive samples. If we see a positive sample then we reject the null hypothesis. Hence, this is also our power:</p>
<p><span class="math display">\[
\text{Power} = 1 - (1 - p)^n
\]</span> This very simple expression can be used to guide our study design.</p>
<p>Complete the following R code to implement this formula. What is our power if we assume a prevalence of 5%?</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="detection-1" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define parameters</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="detection-1-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define parameters</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>n</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(\text{Power} = 0.994\)</span> if we assume a prevalence of <span class="math inline">\(p = 0.05\)</span>.</p>
</details>
<p><br></p>
<p>Based on this result, we are over-powered to detect <em>pfk13</em> mutants, meaning we can reduce the sample size. So, how many samples are needed? Rearranging our power formula to be in terms of <span class="math inline">\(n\)</span> we obtain: <span class="math display">\[
n = \frac{\text{log}(1 - \text{Power})}{\text{log}(1 - p)}
\]</span></p>
<p>Complete the following R code to implement this sample size formula. What minimum sample size is needed if we assume a prevalence of 5% and we are aiming for 80% power?</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="detection-2" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define prevalence</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minimum sample size</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="detection-2-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define prevalence</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minimum sample size</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.8</span>) <span class="sc">/</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> p)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(n = 31.38\)</span>, which would be rounded up to <span class="math inline">\(n = 32\)</span>.</p>
</details>
<p><br></p>
<p>This is a very promising result - we can definitely run a well-powered study within our resource constraints. However, we did make the fairly pessimistic assumption that validated <em>pfk13</em> mutants are already at 5% prevalence in the population. In reality, we may want to catch them before they reach 5% in order to take pre-emptive measures. Again, we can consult a sample size table (<strong>Table 2</strong>):</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Assumed prevalence of pfk13 mutations</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 5cm;">0.1%</td>
<td style="text-align: right; width: 4cm;">1609</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 5cm;">0.5%</td>
<td style="text-align: right; width: 4cm;">322</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 5cm;">1%</td>
<td style="text-align: right; width: 4cm;">161</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 5cm;">2%</td>
<td style="text-align: right; width: 4cm;">80</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 5cm;">3%</td>
<td style="text-align: right; width: 4cm;">53</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 5cm;">4%</td>
<td style="text-align: right; width: 4cm;">40</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 5cm;">5%</td>
<td style="text-align: right; width: 4cm;">32</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup><br>
Table 2: minimum sample sizes under various assumptions about pfk13 mutation prevalence</td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
<div style="padding: 10px; border-radius: 5px; background-color: #fef3e7;">
<p><span style="font-size: 1.2em; color: #d19554;"> <i class="fas fa-comment"></i> Reflection: </span></p>
<p><span style="color:#d19554;"> Based on the values in <strong>Table 2</strong>, do you think it is worthwhile to conduct this study? If you ran a study that was powered down to 2% prevalence (80 samples) and did not find any <em>pfk13</em> mutants, would you be reassured by this result? </span></p>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
knitr::opts_chunk$set(warning = FALSE,
                      echo = FALSE)

# needed for longer calculations (eg DRpower) note - in seconds
tutorial_options(exercise.timelimit = 120)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::prepare_tutorial_state(session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::i18n_observe_tutorial_language(input, session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-q1-1", question = structure("What is a null hypothesis?", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_506a695", 
    option = "A statement that there is a significant effect or difference between groups.", 
    value = "A statement that there is a significant effect or difference between groups.", 
    label = structure("A statement that there is a significant effect or difference between groups.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_615d224", 
    option = "A prediction about the future outcome of an experiment.", 
    value = "A prediction about the future outcome of an experiment.", 
    label = structure("A prediction about the future outcome of an experiment.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_7abd17", 
    option = "A statement that there is no effect or no difference between groups, and any observed effect is due to chance.", 
    value = "A statement that there is no effect or no difference between groups, and any observed effect is due to chance.", 
    label = structure("A statement that there is no effect or no difference between groups, and any observed effect is due to chance.", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_b73f04b", 
    option = "A hypothesis that describes the expected relationship between two variables.", 
    value = "A hypothesis that describes the expected relationship between two variables.", 
    label = structure("A hypothesis that describes the expected relationship between two variables.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
"character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("That is correct! A null hypothesis assumes there is no effect/difference between groups. Often the null hypothesis is a statement that there is nothing interesting going on - but not always! For example, imagine our null hypothesis is that people using bed nets have the same malaria incidence as those not using bed nets. If this null hypothesis is true then that is very interesting indeed.", html = TRUE, class = c("html", 
"character")), try_again = structure("Hint: when you see the word ‘null’ think ‘nothing’.", html = TRUE, class = c("html", 
"character")), incorrect = structure("Hint: when you see the word ‘null’ think ‘nothing’.", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "quiz-q1-1-answer", question = "quiz-q1-1"), loading = NULL, 
    random_answer_order = FALSE, allow_retry = TRUE, seed = 194467248.409444, 
    options = list()), class = c("learnr_radio", "tutorial_question"
)), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-q1-2", question = structure("Which of these is <em>not<\u002fem> a null hypothesis?", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_eede448", 
    option = "There is no difference in malaria prevalence between people who sleep under bed nets and people who do not.", 
    value = "There is no difference in malaria prevalence between people who sleep under bed nets and people who do not.", 
    label = structure("There is no difference in malaria prevalence between people who sleep under bed nets and people who do not.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_c8fbc45", 
    option = "The presence of a genetic marker for drug resistance is independent of the region (e.g., East Africa vs. West Africa).", 
    value = "The presence of a genetic marker for drug resistance is independent of the region (e.g., East Africa vs. West Africa).", 
    label = structure("The presence of a genetic marker for drug resistance is independent of the region (e.g., East Africa vs. West Africa).", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_a7ee7a8", 
    option = "Elevation has no linear relationship with malaria risk.", 
    value = "Elevation has no linear relationship with malaria risk.", 
    label = structure("Elevation has no linear relationship with malaria risk.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_639ec5f", 
    option = "Malaria incidence is twice as high in men as it is in women.", 
    value = "Malaria incidence is twice as high in men as it is in women.", 
    label = structure("Malaria incidence is twice as high in men as it is in women.", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
"character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("That is correct! This cannot be a null hypothesis as it expresses a difference between two groups. The null hypothesis would be that there is no difference in incidence between men and women.", html = TRUE, class = c("html", 
"character")), try_again = structure("Hint: for each statement, try to work out if it assumes an effect/difference or no effect between groups.", html = TRUE, class = c("html", 
"character")), incorrect = structure("Hint: for each statement, try to work out if it assumes an effect/difference or no effect between groups.", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "quiz-q1-2-answer", question = "quiz-q1-2"), loading = NULL, 
    random_answer_order = FALSE, allow_retry = TRUE, seed = 96459478.4550826, 
    options = list()), class = c("learnr_radio", "tutorial_question"
)), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-q1-3", question = structure("A false-negative result is when…", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_5d28186", 
    option = "You fail to reject the null hypothesis when it is actually false.", 
    value = "You fail to reject the null hypothesis when it is actually false.", 
    label = structure("You fail to reject the null hypothesis when it is actually false.", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_92a62ea", 
    option = "You fail to reject the null hypothesis when it is actually true.", 
    value = "You fail to reject the null hypothesis when it is actually true.", 
    label = structure("You fail to reject the null hypothesis when it is actually true.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = structure("You’re right that this is a negative result, but this is a true-negative rather than a false-negative.", html = TRUE, class = c("html", 
    "character")), type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_58a64d1", 
    option = "You reject the null hypothesis when it is actually false.", 
    value = "You reject the null hypothesis when it is actually false.", 
    label = structure("You reject the null hypothesis when it is actually false.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = structure("This is the opposite of a false-negative result; this is a true-positive result.", html = TRUE, class = c("html", 
    "character")), type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_5d3a39c", 
    option = "You reject the null hypothesis when it is actually true.", 
    value = "You reject the null hypothesis when it is actually true.", 
    label = structure("You reject the null hypothesis when it is actually true.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = structure("You’re right that this is a false result, but it is a false-positive rather than a false-negative.", html = TRUE, class = c("html", 
    "character")), type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
"character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("That is correct! A false-negative result means we failed to detect an effect that was really there.", html = TRUE, class = c("html", 
"character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
"character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "quiz-q1-3-answer", question = "quiz-q1-3"), loading = NULL, 
    random_answer_order = FALSE, allow_retry = TRUE, seed = 4582196.99786625, 
    options = list()), class = c("learnr_radio", "tutorial_question"
)), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-q1-4", question = structure("The parameter \\(\\alpha\\) is often referred to as…", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_5d57bd2", 
    option = "The confidence level of a hypothesis test.", value = "The confidence level of a hypothesis test.", 
    label = structure("The confidence level of a hypothesis test.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_35eb2e2", 
    option = "The significance level of a hypothesis test.", 
    value = "The significance level of a hypothesis test.", label = structure("The significance level of a hypothesis test.", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_17e760f", 
    option = "The power of a statistical test.", value = "The power of a statistical test.", 
    label = structure("The power of a statistical test.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_dbf5bf3", 
    option = "The probability of making a Type II error.", value = "The probability of making a Type II error.", 
    label = structure("The probability of making a Type II error.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
"character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("That is correct! Smaller values of \\(\\alpha\\) make it harder for us to reject the null hypothesis.", html = TRUE, class = c("html", 
"character")), try_again = structure("Hint: \\(\\alpha\\) is the threshold we set to decide if a result is statistically significant.", html = TRUE, class = c("html", 
"character")), incorrect = structure("Hint: \\(\\alpha\\) is the threshold we set to decide if a result is statistically significant.", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "quiz-q1-4-answer", question = "quiz-q1-4"), loading = NULL, 
    random_answer_order = FALSE, allow_retry = TRUE, seed = 1537135444.28422, 
    options = list()), class = c("learnr_radio", "tutorial_question"
)), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-q1-5", question = structure("A statistical test that only examines effects in one direction is called…", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_4672231", 
    option = "A one-headed test.", value = "A one-headed test.", 
    label = structure("A one-headed test.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_838f07", 
    option = "A one-way street analysis.", value = "A one-way street analysis.", 
    label = structure("A one-way street analysis.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_b4c08ed", 
    option = "A wild goose chase.", value = "A wild goose chase.", 
    label = structure("A wild goose chase.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_ae3ec94", 
    option = "A one-tailed test.", value = "A one-tailed test.", 
    label = structure("A one-tailed test.", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
"character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("That is correct! A one-tailed test assumes that we already know the direction of the effect - for example, that bed nets will decrease the incidence of malaria, not increase it. One-tailed tests tend to be easier to disprove, but we have to be sure about the direction of the effect.", html = TRUE, class = c("html", 
"character")), try_again = structure("Hint: the ‘tails’ of a distribution refer to the low probability regions on either side of the main hump.", html = TRUE, class = c("html", 
"character")), incorrect = structure("Hint: the ‘tails’ of a distribution refer to the low probability regions on either side of the main hump.", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "quiz-q1-5-answer", question = "quiz-q1-5"), loading = NULL, 
    random_answer_order = FALSE, allow_retry = TRUE, seed = 1545618120.78027, 
    options = list()), class = c("learnr_radio", "tutorial_question"
)), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-q1-6", question = structure("In statistical testing, we always compare our test statistic against the normal distribution.", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_abe9ea2", 
    option = "TRUE", value = "TRUE", label = structure("TRUE", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_42a338c", 
    option = "FALSE", value = "FALSE", label = structure("FALSE", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
"character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("That is correct! Different statistical tests can have different distributions for the test statistic - for example, the chi-squared test statistic follows a chi-squared distribution. We need to know the correct distribution to compare against when assessing significance.", html = TRUE, class = c("html", 
"character")), try_again = structure("Hint: is a test statistic always normally distributed?", html = TRUE, class = c("html", 
"character")), incorrect = structure("Hint: is a test statistic always normally distributed?", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "quiz-q1-6-answer", question = "quiz-q1-6"), loading = NULL, 
    random_answer_order = FALSE, allow_retry = TRUE, seed = 1568642061.76954, 
    options = list()), class = c("learnr_radio", "tutorial_question"
)), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-q1-7", question = structure("You are running a study to test if the prevalence of a drug resistant mutation has changed over time. You analyse your data using a z-test. The critical values for a two-tailed z-test at the significance level \\(\\alpha = 0.05\\) are at \\(\\pm1.96\\). You obtain a test statistic of -2.54. What should you do based on this result?", html = TRUE, class = c("html", 
"character")), answers = list(structure(list(id = "lnr_ans_82f5459", 
    option = "Reject the null hypothesis because the test statistic is less than zero.", 
    value = "Reject the null hypothesis because the test statistic is less than zero.", 
    label = structure("Reject the null hypothesis because the test statistic is less than zero.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_72c0806", 
    option = "Reject the null hypothesis because the test statistic is less than the lower critical value.", 
    value = "Reject the null hypothesis because the test statistic is less than the lower critical value.", 
    label = structure("Reject the null hypothesis because the test statistic is less than the lower critical value.", html = TRUE, class = c("html", 
    "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_a89f0e3", 
    option = "Fail to reject the null hypothesis because the test statistic is negative.", 
    value = "Fail to reject the null hypothesis because the test statistic is negative.", 
    label = structure("Fail to reject the null hypothesis because the test statistic is negative.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer")), structure(list(id = "lnr_ans_684d687", 
    option = "Fail to reject the null hypothesis because the test statistic is less than the upper critical value.", 
    value = "Fail to reject the null hypothesis because the test statistic is less than the upper critical value.", 
    label = structure("Fail to reject the null hypothesis because the test statistic is less than the upper critical value.", html = TRUE, class = c("html", 
    "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
"tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
"character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
"character"))), messages = list(correct = structure("That is correct! The test statistic is negative, meaning we are comparing against the lower critical value of -1.96. The test statistic is greater in magnitude than the critical value, so we should reject the null hypothesis.", html = TRUE, class = c("html", 
"character")), try_again = structure("Hint: we reject the null hypothesis when the observed value is outside the range -1.96 to +1.96.", html = TRUE, class = c("html", 
"character")), incorrect = structure("Hint: we reject the null hypothesis when the observed value is outside the range -1.96 to +1.96.", html = TRUE, class = c("html", 
"character")), message = NULL, post_message = NULL), ids = list(
    answer = "quiz-q1-7-answer", question = "quiz-q1-7"), loading = NULL, 
    random_answer_order = FALSE, allow_retry = TRUE, seed = 372973543.326321, 
    options = list()), class = c("learnr_radio", "tutorial_question"
)), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "ztest-quiz-1", 
    question = structure("Which of these is the correct null hypothesis under the planned test?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_19dae4d", 
        option = "The prevalence of *pfmdr1* N86Y mutations has increased from 15% over the past three years.", 
        value = "The prevalence of *pfmdr1* N86Y mutations has increased from 15% over the past three years.", 
        label = structure("The prevalence of <em>pfmdr1<\u002fem> N86Y mutations has increased from 15% over the past three years.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_5da60b8", 
        option = "The prevalence of *pfmdr1* N86Y mutations has decreased from 15% over the past three years.", 
        value = "The prevalence of *pfmdr1* N86Y mutations has decreased from 15% over the past three years.", 
        label = structure("The prevalence of <em>pfmdr1<\u002fem> N86Y mutations has decreased from 15% over the past three years.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_5022eb8", 
        option = "The prevalence of *pfmdr1* N86Y mutations is still 15%, the same as it was three years ago.", 
        value = "The prevalence of *pfmdr1* N86Y mutations is still 15%, the same as it was three years ago.", 
        label = structure("The prevalence of <em>pfmdr1<\u002fem> N86Y mutations is still 15%, the same as it was three years ago.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_1e1cc05", 
        option = "The prevalence of *pfmdr1* N86Y mutations has changed from its earlier value of 15%.", 
        value = "The prevalence of *pfmdr1* N86Y mutations has changed from its earlier value of 15%.", 
        label = structure("The prevalence of <em>pfmdr1<\u002fem> N86Y mutations has changed from its earlier value of 15%.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("That is correct! It is the only option that specifies no effect/difference in the mutation prevalence between the two time periods.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: remember that a null hypothesis is a statement of no effect or difference between groups.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: remember that a null hypothesis is a statement of no effect or difference between groups.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "ztest-quiz-1-answer", question = "ztest-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1213499793.43492, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ztest-1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ztest-1-code-editor`)), session)
output$`tutorial-exercise-ztest-1-output` <- renderUI({
  `tutorial-exercise-ztest-1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "ztest-1", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "ztest-1", code = "# input parameters\np0 <- \np <- \nn <- \n\n# calculate absolute value of difference in prevalence\np_diff <- abs(p - p0)\n\n# calculate the standard error\nSE <- sqrt(p*(1 - p) / n)\n\n# calculate the expected value of the statistic\nE_Z <- \n\nprint(E_Z)", 
        opts = list(label = "\"ztest-1\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# input parameters", 
    "p0 <- 0.15", "p <- 0.3", "n <- 150", "", "# calculate absolute value of difference in prevalence", 
    "p_diff <- abs(p - p0)", "", "# calculate the standard error", 
    "SE <- sqrt(p*(1 - p) / n)", "", "# calculate the expected value of the statistic", 
    "E_Z <- p_diff / SE", "", "print(E_Z)"), chunk_opts = list(
        label = "ztest-1-solution")), tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "activity3_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity3_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "ztest-1", exercise = TRUE, original.params.src = "r ztest-1, exercise=TRUE", 
        chunk.echo = FALSE, code = c("# input parameters", "p0 <- ", 
        "p <- ", "n <- ", "", "# calculate absolute value of difference in prevalence", 
        "p_diff <- abs(p - p0)", "", "# calculate the standard error", 
        "SE <- sqrt(p*(1 - p) / n)", "", "# calculate the expected value of the statistic", 
        "E_Z <- ", "", "print(E_Z)"), out.width.px = 672L, out.height.px = 480L, 
        params.src = "r ztest-1, exercise=TRUE", fig.num = 0, 
        exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ztest-2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ztest-2-code-editor`)), session)
output$`tutorial-exercise-ztest-2-output` <- renderUI({
  `tutorial-exercise-ztest-2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "ztest-2", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = "p0 <- 0.15\np <- 0.3\nn <- 150\nE_Z <- abs(p - p0) / sqrt(p*(1 - p) / n)", 
    chunks = list(list(label = "ztest-2-params", code = "p0 <- 0.15\np <- 0.3\nn <- 150\nE_Z <- abs(p - p0) / sqrt(p*(1 - p) / n)", 
        opts = list(label = "\"ztest-2-params\""), engine = "r"), 
        list(label = "ztest-2", code = "# calculate power using the known value of E_Z\nz_alpha <- 1.96\npower <- # hint, you will need to use the pnorm() function here\n\nprint(power)", 
            opts = list(label = "\"ztest-2\"", exercise = "TRUE", 
                exercise.setup = "\"ztest-2-params\""), engine = "r")), 
    code_check = NULL, error_check = NULL, check = NULL, solution = structure(c("# calculate power using the known value of E_Z", 
    "z_alpha <- 1.96", "power <- 1 - pnorm(z_alpha - E_Z)", "", 
    "print(power)"), chunk_opts = list(label = "ztest-2-solution")), 
    tests = NULL, options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "activity3_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity3_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "ztest-2", exercise = TRUE, exercise.setup = "ztest-2-params", 
        original.params.src = "r ztest-2, exercise=TRUE, exercise.setup = \"ztest-2-params\"", 
        chunk.echo = FALSE, code = c("# calculate power using the known value of E_Z", 
        "z_alpha <- 1.96", "power <- # hint, you will need to use the pnorm() function here", 
        "", "print(power)"), out.width.px = 672L, out.height.px = 480L, 
        params.src = "r ztest-2, exercise=TRUE, exercise.setup = \"ztest-2-params\"", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "power-quiz-1", 
    question = structure("A power of 98% means…", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_a3ec788", 
        option = "There is a 98% chance that the study will be successful.", 
        value = "There is a 98% chance that the study will be successful.", 
        label = structure("There is a 98% chance that the study will be successful.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_3d961ae", 
        option = "There is a 98% difference in prevalence between the time points.", 
        value = "There is a 98% difference in prevalence between the time points.", 
        label = structure("There is a 98% difference in prevalence between the time points.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_fd6509d", 
        option = "There is a 98% chance that the alternative hypothesis is true.", 
        value = "There is a 98% chance that the alternative hypothesis is true.", 
        label = structure("There is a 98% chance that the alternative hypothesis is true.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_18e0cd9", 
        option = "Assuming the alternative hypothesis is true, there is a 98% chance that we will correctly reject the null hypothesis.", 
        value = "Assuming the alternative hypothesis is true, there is a 98% chance that we will correctly reject the null hypothesis.", 
        label = structure("Assuming the alternative hypothesis is true, there is a 98% chance that we will correctly reject the null hypothesis.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("That is correct! Under the current study design there is a 98% chance that we will correctly conclude that prevalence has changed over the three year period, assuming that it doubled from 15% to 30% over this time.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: power is the chance of correctly rejecting the null hypothesis.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: power is the chance of correctly rejecting the null hypothesis.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "power-quiz-1-answer", question = "power-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1814860796.15489, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "power-curve-quiz-1", 
    question = structure("From this graph, what is the minimum sample size needed to achieve 80% power?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_2dc28eb", 
        option = "60", value = "60", label = structure("60", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_3b756f3", 
        option = "74", value = "74", label = structure("74", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_f063d81", 
        option = "100", value = "100", label = structure("100", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_ca787e8", 
        option = "More than 150", value = "More than 150", label = structure("More than 150", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("That is correct! Our planned sample size of 150 is more than double what we need to achieve 80% power.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: look for the point at which the curve intersects the shaded region.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: look for the point at which the curve intersects the shaded region.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "power-curve-quiz-1-answer", question = "power-curve-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1303196981.89315, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ztest-ss-2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ztest-ss-2-code-editor`)), session)
output$`tutorial-exercise-ztest-ss-2-output` <- renderUI({
  `tutorial-exercise-ztest-ss-2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "ztest-ss-2", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "ztest-ss-2", code = "# define our assumed values\np0 <- 0.15\np <- 0.30\n\n# define the two z parameters\nz_alpha <- 1.96\nz_beta <- qnorm(0.8)\n\n# calculate the minimum sample size\n(z_alpha + z_beta)^2 * p*(1 - p) / (p - p0)^2", 
        opts = list(label = "\"ztest-ss-2\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = NULL, tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "activity3_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity3_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "ztest-ss-2", exercise = TRUE, original.params.src = "r ztest-ss-2, exercise=TRUE", 
        chunk.echo = FALSE, code = c("# define our assumed values", 
        "p0 <- 0.15", "p <- 0.30", "", "# define the two z parameters", 
        "z_alpha <- 1.96", "z_beta <- qnorm(0.8)", "", "# calculate the minimum sample size", 
        "(z_alpha + z_beta)^2 * p*(1 - p) / (p - p0)^2"), out.width.px = 672L, 
        out.height.px = 480L, params.src = "r ztest-ss-2, exercise=TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-detection-1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-detection-1-code-editor`)), session)
output$`tutorial-exercise-detection-1-output` <- renderUI({
  `tutorial-exercise-detection-1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "detection-1", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "detection-1", code = "# define parameters\np <- \nn <- \n\n# calculate power\npower <- \n\nprint(power)", 
        opts = list(label = "\"detection-1\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# define parameters", 
    "p <- 0.05", "n <- 100", "", "# calculate power", "power <- 1 - (1 - p)^n", 
    "", "print(power)"), chunk_opts = list(label = "detection-1-solution")), 
    tests = NULL, options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "activity3_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity3_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "detection-1", exercise = TRUE, original.params.src = "r detection-1, exercise=TRUE", 
        chunk.echo = FALSE, code = c("# define parameters", "p <- ", 
        "n <- ", "", "# calculate power", "power <- ", "", "print(power)"
        ), out.width.px = 672L, out.height.px = 480L, params.src = "r detection-1, exercise=TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-detection-2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-detection-2-code-editor`)), session)
output$`tutorial-exercise-detection-2-output` <- renderUI({
  `tutorial-exercise-detection-2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "detection-2", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "detection-2", code = "# define prevalence\np <- \n\n# calculate minimum sample size\nn <- \n\nprint(n)", 
        opts = list(label = "\"detection-2\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# define prevalence", 
    "p <- 0.05", "", "# calculate minimum sample size", "n <- log(1 - 0.8) / log(1 - p)", 
    "", "print(n)"), chunk_opts = list(label = "detection-2-solution")), 
    tests = NULL, options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "activity3_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity3_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fenced.echo = FALSE, ft.shadow = FALSE, exercise.timelimit = 120, 
        label = "detection-2", exercise = TRUE, original.params.src = "r detection-2, exercise=TRUE", 
        chunk.echo = FALSE, code = c("# define prevalence", "p <- ", 
        "", "# calculate minimum sample size", "n <- ", "", "print(n)"
        ), out.width.px = 672L, out.height.px = 480L, params.src = "r detection-2, exercise=TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["5.5.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.5.9000"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5.9000"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.3.4"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70]}},"value":[{"type":"character","attributes":{},"value":["backports","base","checkmate","cli","colorspace","commonmark","compiler","datasets","digest","dplyr","evaluate","fansi","farver","fastmap","fontawesome","generics","ggplot2","glue","graphics","grDevices","grid","gtable","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","kableExtra","knitr","later","learnr","lifecycle","magrittr","markdown","methods","mime","munsell","pillar","pkgconfig","promises","purrr","R6","Rcpp","rlang","rmarkdown","rprojroot","rstudioapi","rvest","scales","shiny","stats","stringi","stringr","svglite","systemfonts","tibble","tidyr","tidyselect","tools","utf8","utils","vctrs","viridisLite","webshot","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.5.0","4.3.1","2.3.2","3.6.3","2.1-1","1.9.2","4.3.1","4.3.1","0.6.37","1.1.4","1.0.0","1.0.6","2.1.2","1.2.0","0.5.2","0.1.3","3.5.1","1.8.0","4.3.1","4.3.1","4.3.1","0.3.6","0.5.8.1","1.6.4","1.6.15","1.4.7","0.1.4","1.8.9","1.3.4","1.48","1.3.2","0.11.5.9000","1.0.4","2.0.3","1.13","4.3.1","0.12","0.5.1","1.9.0","2.0.3","1.3.0","1.0.2","2.5.1","1.0.13-1","1.1.4","2.28","2.0.4","0.16.0","1.0.3","1.3.0","1.9.1","4.3.1","1.8.4","1.5.1","2.1.3","1.0.6","3.2.1","1.3.1","1.2.1","4.3.1","1.2.4","4.3.1","0.6.5","0.4.2","0.5.5","3.0.2","0.48","1.3.6","1.8-4","2.3.10"]}]}]}
</script>
<!--/html_preserve-->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>