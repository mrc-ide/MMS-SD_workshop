<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Activity 4: Statistical Power – Malaria Molecular Surveillance Study Design workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8610558a007458a9b978551a034f4d85.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Malaria Molecular Surveillance Study Design workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-events" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-calendar" role="img">
</i> 
 <span class="menu-text">Events</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-events">    
        <li>
    <a class="dropdown-item" href="../../events.html">
 <span class="dropdown-text">Events overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../workshop2024.html">
 <span class="dropdown-text">2024 New Orleans Workshop</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../workshop2025.html">
 <span class="dropdown-text">2025 Toronto workshop (upcoming)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../lectures.html"> <i class="bi bi-bookmark" role="img">
</i> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../../tutorials.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://shiny.dide.ic.ac.uk/mms-sd-workshop/module1/"><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Activity 1 - Sampling from a population</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://shiny.dide.ic.ac.uk/mms-sd-workshop/module2/"><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Activity 2 - Sample size calculation based on margin of error</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://shiny.dide.ic.ac.uk/mms-sd-workshop/module3/"><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Activity 3 - Hypothesis testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://shiny.dide.ic.ac.uk/mms-sd-workshop/module4/"><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Activity 4 - Statistical power</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://shiny.dide.ic.ac.uk/mms-sd-workshop/module5/"><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Activity 5 - Dealing with overdispersion in multi-cluster studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://shiny.dide.ic.ac.uk/mms-sd-workshop/module6/"><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Activity 6 - The DRpower tool</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/module7/module7_scenarios.html"><i class="bi bi-play" role="img">
</i> 
 <span class="dropdown-text">Activity 7 - Designing a study for multiple end-points</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link" data-scroll-target="#learning-outcomes">Learning Outcomes</a></li>
  </ul></li>
  <li><a href="#designing-a-study-to-compare-prevalence-of-resistance-mutations-against-a-threshold" id="toc-designing-a-study-to-compare-prevalence-of-resistance-mutations-against-a-threshold" class="nav-link" data-scroll-target="#designing-a-study-to-compare-prevalence-of-resistance-mutations-against-a-threshold">Designing a Study to Compare Prevalence of Resistance Mutations Against a Threshold</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#recapping-the-one-sample-z-test-for-proportions" id="toc-recapping-the-one-sample-z-test-for-proportions" class="nav-link" data-scroll-target="#recapping-the-one-sample-z-test-for-proportions">Recapping the one-sample z-test for proportions</a></li>
  <li><a href="#defining-the-alternative-hypothesis" id="toc-defining-the-alternative-hypothesis" class="nav-link" data-scroll-target="#defining-the-alternative-hypothesis">Defining the alternative hypothesis</a></li>
  <li><a href="#using-power-curves" id="toc-using-power-curves" class="nav-link" data-scroll-target="#using-power-curves">Using power curves</a></li>
  <li><a href="#using-a-sample-size-formula" id="toc-using-a-sample-size-formula" class="nav-link" data-scroll-target="#using-a-sample-size-formula">Using a sample size formula</a></li>
  <li><a href="#using-sample-size-tables" id="toc-using-sample-size-tables" class="nav-link" data-scroll-target="#using-sample-size-tables">Using sample size tables</a></li>
  <li><a href="#buffering-for-drop-out" id="toc-buffering-for-drop-out" class="nav-link" data-scroll-target="#buffering-for-drop-out">Buffering for drop-out</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul></li>
  <li><a href="#detecting-rare-variants" id="toc-detecting-rare-variants" class="nav-link" data-scroll-target="#detecting-rare-variants">Detecting rare variants</a>
  <ul class="collapse">
  <li><a href="#background-1" id="toc-background-1" class="nav-link" data-scroll-target="#background-1">Background</a></li>
  <li><a href="#framing-the-problem-as-a-hypothesis-test" id="toc-framing-the-problem-as-a-hypothesis-test" class="nav-link" data-scroll-target="#framing-the-problem-as-a-hypothesis-test">Framing the problem as a hypothesis test</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Activity 4: Statistical Power</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome to Activity 4: <strong>Statistical Power</strong></p>
<p>In this activity, we build on what you’ve learned about hypothesis testing by introducing the concept of statistical power — the probability of detecting a real effect when it truly exists. Power analysis helps us answer a crucial question in study design: <em>If there is a real difference, how likely is our study to find it?</em></p>
<section id="learning-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="learning-outcomes">Learning Outcomes</h3>
<p>By the end of this tutorial, you will be able to:</p>
<ul>
<li>Perform power analysis using two different statistical tests.</li>
<li>Interpret power curves.</li>
<li>Use minimum sample size tables.</li>
</ul>
<p><em>Disclaimer: The scenarios in this document are entirely fictitious. While real place names are used, the data itself is artificial and designed for teaching purposes only. It does not necessarily represent the real epidemiological situation in these locations.</em></p>
</section>
</section>
<section id="designing-a-study-to-compare-prevalence-of-resistance-mutations-against-a-threshold" class="level2">
<h2 class="anchored" data-anchor-id="designing-a-study-to-compare-prevalence-of-resistance-mutations-against-a-threshold">Designing a Study to Compare Prevalence of Resistance Mutations Against a Threshold</h2>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<p>You are a molecular surveillance scientist working in Pemba, a coastal city in northern Mozambique. Following the recent findings from Mtwara, Tanzania — where the <em>dhps</em> A437G mutation was found in more than 5% of infections — your team wants to know whether a similar pattern might be emerging in your region.</p>
<p>This time, you are still in the planning stage. Before any samples are collected, you need to design a study that will give you a good chance of detecting an elevated level of resistance if it truly exists. In other words, you want to know: <strong>How many infections should we sample and sequence to have a strong chance of detecting a true prevalence above 5%?</strong></p>
</section>
<section id="recapping-the-one-sample-z-test-for-proportions" class="level3">
<h3 class="anchored" data-anchor-id="recapping-the-one-sample-z-test-for-proportions">Recapping the one-sample z-test for proportions</h3>
<p>The first step in any power analysis is to define a clear analysis plan. We need to specify what data will be collected and how it will be analysed.</p>
<p>In this study, we will collect genetic data as counts: the number of samples carrying the mutation out of the total number successfully sequenced. Dividing these gives the observed prevalence of the mutation, expressed as a proportion between 0 and 1.</p>
<p>We will compare this observed proportion against a fixed reference value of 5%. From our earlier work on hypothesis testing, we know that the appropriate statistical test to use here is the one-sample z-test for proportions.</p>
<p>The test statistic is given by:</p>
<p>[ z = ]</p>
<p>where:</p>
<ul>
<li>() = observed sample proportion<br>
</li>
<li>(p_0) = null (expected) proportion<br>
</li>
<li>(n) = sample size</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ – Sample Size and Power</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-choose-test-1" class="tutorial-question panel-body">
<div id="quiz-choose-test-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-choose-test-1-message_container" class="shiny-html-output"></div>
<div id="quiz-choose-test-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
</section>
<section id="defining-the-alternative-hypothesis" class="level3">
<h3 class="anchored" data-anchor-id="defining-the-alternative-hypothesis">Defining the alternative hypothesis</h3>
<p>So far, we’ve only looked at the null distribution — what we would expect to see if the null hypothesis were true. Now it’s time to consider the <strong>alternative hypothesis</strong>, which represents a real effect or difference.</p>
<p>In our case, the alternative hypothesis means that the true prevalence, which we’ll call <span class="math inline">\(p\)</span>, is not equal to the threshold value <span class="math inline">\(p_0\)</span>.</p>
<p>While there is only one null hypothesis, there are many possible alternatives. For example, <span class="math inline">\(p\)</span> could be 0.1 or 0.5 — both values differ from the null threshold of <span class="math inline">\(p_0 = 0.05\)</span>, but they would lead to different test outcomes and different statistical power.</p>
<p>The plot below shows the distribution of the test statistic that we would expect under the <em>alternative</em> hypothesis. Use the sliders to explore how changing each parameter affects the distribution.</p>
<div class="cell">
<div class="cell-output-display">
<div class="container-fluid">
<div class="shiny-plot-output html-fill-item" id="normalPlot" style="width:500px;height:300px;"></div>
<div class="form-group shiny-input-container" style="width:60%;">
<label class="control-label" id="p_true-label" for="p_true">True prevalence (%):</label>
<input class="js-range-slider" id="p_true" data-skin="shiny" data-min="0" data-max="100" data-from="10" data-step="1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
<div class="form-group shiny-input-container" style="width:60%;">
<label class="control-label" id="p_thresh-label" for="p_thresh">Threshold (%):</label>
<input class="js-range-slider" id="p_thresh" data-skin="shiny" data-min="0" data-max="100" data-from="5" data-step="1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
<div class="form-group shiny-input-container" style="width:60%;">
<label class="control-label" id="n-label" for="n">Sample size:</label>
<input class="js-range-slider" id="n" data-skin="shiny" data-min="5" data-max="1000" data-from="100" data-step="1" data-grid="true" data-grid-num="9.95" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ – Exploring the Alternative Hypothesis</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-alternative-test-1" class="tutorial-question panel-body">
<div id="quiz-alternative-test-1-answer_container" class="shiny-html-output"></div>
<div id="quiz-alternative-test-1-message_container" class="shiny-html-output"></div>
<div id="quiz-alternative-test-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="quiz-alternative-test-2" class="tutorial-question panel-body">
<div id="quiz-alternative-test-2-answer_container" class="shiny-html-output"></div>
<div id="quiz-alternative-test-2-message_container" class="shiny-html-output"></div>
<div id="quiz-alternative-test-2-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>Let’s look at how to calculate power directly in R.</p>
<p>We start by calculating the mean of the distribution under the alternative hypothesis. This is given by: <span class="math display">\[
E[Z] = \frac{|p - p_0|}{\sqrt{\frac{p(1-p)}{n}}}
\]</span> The vertical lines around <span class="math inline">\(|p - p_0|\)</span> indicate that we should take the <em>absolute value</em> of the difference. This ensures that <span class="math inline">\(E[Z]\)</span> is always positive.</p>
<p>Complete the following R code to calculate the value of <span class="math inline">\(E[Z]\)</span>, assuming a true prevalence of <span class="math inline">\(p = 0.20\)</span>, a threshold of <span class="math inline">\(p_0 = 0.05\)</span>, and a sample size of <span class="math inline">\(n = 100\)</span>.</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="ztest-1" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input parameters</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> ?</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> ?</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> ?</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate absolute value of difference in prevalence</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>p_diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(p <span class="sc">-</span> p0)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the standard error</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> n)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the expected value of the statistic</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>E_Z <span class="ot">&lt;-</span> ?</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(E_Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="ztest-1-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input parameters</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate absolute value of difference in prevalence</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>p_diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(p <span class="sc">-</span> p0)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the standard error</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> n)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the expected value of the statistic</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>E_Z <span class="ot">&lt;-</span> p_diff <span class="sc">/</span> SE</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(E_Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(E[Z] = 3.75\)</span>.</p>
</details>
<p><br></p>
<p>This means that <em>on average</em> we should expect our test statistic to equal <span class="math inline">\(3.75\)</span> if this alternative hypothesis is true.</p>
<p>We can plug this value of <span class="math inline">\(E[Z]\)</span> into the following formula for power under the z-test:</p>
<p><span class="math display">\[
\text{Power} = 1 - \phi(z_{1-\alpha/2} - E[Z])
\]</span></p>
<p><span class="math inline">\(\phi()\)</span> in this formula refers to the area under the curve of a standard normal distribution. There is no simple way of calculating this value by hand, but we can obtain it easily in R using the <code>pnorm()</code> function. As in previous activities, the value <span class="math inline">\(z_{1 - \alpha/2}\)</span> refers to the critical value of the normal distribution at a significance level <span class="math inline">\(\alpha\)</span> (two-tailed), which is approximately equal to <span class="math inline">\(z_{1 - \alpha/2} = 1.96\)</span>.</p>
<p>Complete the following R code to calculate the power under the planned study design.</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="ztest-2" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>E_Z <span class="ot">&lt;-</span> <span class="fl">3.75</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="ot">&lt;-</span> <span class="fl">1.96</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> ?   <span class="co"># hint, you will need to use the pnorm() function here</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="ztest-2-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>E_Z <span class="ot">&lt;-</span> <span class="fl">3.75</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="ot">&lt;-</span> <span class="fl">1.96</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z_alpha <span class="sc">-</span> E_Z)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(\text{Power} = 0.963\)</span>.</p>
</details>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Interpreting power</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="power-quiz-1" class="tutorial-question panel-body">
<div id="power-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="power-quiz-1-message_container" class="shiny-html-output"></div>
<div id="power-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
</section>
<section id="using-power-curves" class="level3">
<h3 class="anchored" data-anchor-id="using-power-curves">Using power curves</h3>
<p>Our current study design has 96% power. We normally aim for at least 80% power, meaning this study is adequately powered. In fact, we could argue that it is <em>over-powered</em>, meaning we could use fewer samples and still have a good chance of detecting a real effect.</p>
<p>We can use power curves to explore how power changes as a function of sample size. In the plot below, the region with at least 80% power is shaded in blue.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="activity4_power_interactive_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Reading off power curves</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="power-curve-quiz-1" class="tutorial-question panel-body">
<div id="power-curve-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="power-curve-quiz-1-message_container" class="shiny-html-output"></div>
<div id="power-curve-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>The power analysis indicates that we may not need to sequence 100 samples after all. However, it did make the rather pessimistic assumption that prevalence is 20%. It would be useful to repeat this analysis, exploring different assumptions about the prevalence. One way to do this is via a series of power curves:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="activity4_power_interactive_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Even small changes in our assumptions about the true prevalence of dhps <em>A437G</em> mutations can have a large impact on statistical power. For example, if we assume the current prevalence is 15% instead of 20%, we would need roughly 100 samples to achieve 80% power.</p>
</section>
<section id="using-a-sample-size-formula" class="level3">
<h3 class="anchored" data-anchor-id="using-a-sample-size-formula">Using a sample size formula</h3>
<p>Power curves are valuable for visualising how power varies with sample size, but reading exact values from a power curve can be fiddly. This is where sample size formulae and pre-calculated sample size tables become useful — they allow us to identify the required sample size for a chosen level of power more quickly and precisely.</p>
<p>Recall that power under the one-sample z-test for proportions is given by <span class="math display">\[
\text{Power} = 1 - \phi\left(z_{1-\alpha/2} - \frac{|p - p_0|}{\sqrt{\frac{p(1 - p)}{n}}} \right)
\]</span> In an earlier module, we rearranged the formula for the Wald confidence interval to express it in terms of the required sample size, <span class="math inline">\(n\)</span>. We’ll take the same approach here - rearranging to get <span class="math inline">\(n\)</span> on the left. This is more fiddly than last time, and so the steps are not shown. The more mathematically inclined can click the button below to see the full derivation, otherwise feel free to skip to the answer!:</p>
<hr>
<details>
<summary style="
  background-color:#888888;
  color:white;
  padding:2px 4px;
  border-radius:4px;
  display:inline-block;
  cursor:pointer;
">
Show full derivation ▼
</summary>
<p><strong>Step 1: Define <span class="math inline">\(\beta\)</span> as the false-negative rate (1 minus the power):</strong></p>
<p><span class="math display">\[
\beta = \phi\left(z_{1-\alpha/2} - \frac{|p - p_0|}{\sqrt{\frac{p(1 - p)}{n}}} \right)
\]</span> <strong>Step 2: Use the inverse normal function on both sides:</strong></p>
<p><span class="math display">\[
z_\beta = z_{1-\alpha/2} - \frac{|p - p_0|}{\sqrt{\frac{p(1 - p)}{n}}}
\]</span> <strong>Step 3: Use the identity that <span class="math inline">\(z_\beta = -z_{1 - \beta}\)</span>:</strong></p>
<p><span class="math display">\[
-z_{1 - \beta} = z_{1-\alpha/2} - \frac{|p - p_0|}{\sqrt{\frac{p(1 - p)}{n}}}
\]</span> <strong>Step 4: Rearrange to get z-values together:</strong></p>
<p><span class="math display">\[
\frac{|p - p_0|}{\sqrt{\frac{p(1 - p)}{n}}} = z_{1-\alpha/2} + z_{1 - \beta}
\]</span> <strong>Step 5: Square both sides:</strong></p>
<p><span class="math display">\[
\frac{(p - p_0)^2}{\frac{p(1 - p)}{n}} = (z_{1-\alpha/2} + z_{1 - \beta})^2
\]</span> <strong>Step 6: Multiply both sides by <span class="math inline">\(p(1-p)/n\)</span>:</strong></p>
<p><span class="math display">\[
(p - p_0)^2 = (z_{1-\alpha/2} + z_{1 - \beta})^2 \frac{p(1 - p)}{n}
\]</span> <strong>Step 7: Multiply both sides by <span class="math inline">\(n\)</span> and divide by <span class="math inline">\((p - p_0)^2\)</span>:</strong></p>
<p><span class="math display">\[
n = (z_{1-\alpha/2} + z_{1 - \beta})^2 \frac{p(1 - p)}{(p - p_0)^2}
\]</span></p>
</details>
<hr>
<p>The final result is: <span class="math display">\[
n = (z_{1 - \alpha/2} + z_{1 - \beta})^2\frac{p(1 - p)}{(p - p_0)^2}
\]</span> The only unfamiliar term here is <span class="math inline">\(z_{1 - \beta}\)</span>, which is the area under the curve of the standard normal distribution up to the value <span class="math inline">\(1 - \beta\)</span>. The parameter <span class="math inline">\(\beta\)</span> is defined as one minus our power. Typically <span class="math inline">\(\beta = 0.2\)</span> because target power is usually set at 80%.</p>
<p>The following R code implements this sample size formula. Have a play around with this code and see how different parameter choices change the final sample size.</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="ztest-ss-2" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define our assumed values</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define the two z parameters</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="ot">&lt;-</span> <span class="fl">1.96</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>z_beta <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.8</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the minimum sample size</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>(z_alpha <span class="sc">+</span> z_beta)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> p<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> (p <span class="sc">-</span> p0)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Using the sample size formula</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="sample_size-quiz-1" class="tutorial-question panel-body">
<div id="sample_size-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="sample_size-quiz-1-message_container" class="shiny-html-output"></div>
<div id="sample_size-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="sample_size-quiz-2" class="tutorial-question panel-body">
<div id="sample_size-quiz-2-answer_container" class="shiny-html-output"></div>
<div id="sample_size-quiz-2-message_container" class="shiny-html-output"></div>
<div id="sample_size-quiz-2-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
</section>
<section id="using-sample-size-tables" class="level3">
<h3 class="anchored" data-anchor-id="using-sample-size-tables">Using sample size tables</h3>
<p>Rather than using the sample size formulae, we may find it easier to produce a table of minimum sample sizes based on different assumptions. <strong>Table 1</strong> shows the minimum sample size required to achieve 80% power under different assumptions about the prevalence:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Assumed prevalence of dhps A437G mutation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Minimum sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 6cm;">6%</td>
<td style="text-align: right; width: 4cm;">4427</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;">8%</td>
<td style="text-align: right; width: 4cm;">642</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;">10%</td>
<td style="text-align: right; width: 4cm;">283</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;">12%</td>
<td style="text-align: right; width: 4cm;">170</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;">14%</td>
<td style="text-align: right; width: 4cm;">117</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;">16%</td>
<td style="text-align: right; width: 4cm;">88</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 6cm;">18%</td>
<td style="text-align: right; width: 4cm;">69</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 6cm;">20%</td>
<td style="text-align: right; width: 4cm;">56</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup><br>
Table 1: minimum sample sizes under various assumptions about present-day prevalence</td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
<p>Notice that the minimum sample size is <em>extremely</em> non-linear with the assumed prevalence. Even a small change from 6% to 8% results in a huge drop in required sample size.</p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Using the sample size tables</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="sample_table-quiz-1" class="tutorial-question panel-body">
<div id="sample_table-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="sample_table-quiz-1-message_container" class="shiny-html-output"></div>
<div id="sample_table-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="sample_table-quiz-2" class="tutorial-question panel-body">
<div id="sample_table-quiz-2-answer_container" class="shiny-html-output"></div>
<div id="sample_table-quiz-2-message_container" class="shiny-html-output"></div>
<div id="sample_table-quiz-2-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
</section>
<section id="buffering-for-drop-out" class="level3">
<h3 class="anchored" data-anchor-id="buffering-for-drop-out">Buffering for drop-out</h3>
<p>Our analysis indicates a minimum sample size of 56. However, remember this is <strong>the number of successfully sequenced samples</strong>, and we should <em>buffer</em> this number to allow for loss of samples.</p>
<p>The formula for buffering was already covered in a previous module - go back over your notes if you need to refresh your memory.</p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Buffering</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="buffer-quiz-1" class="tutorial-question panel-body">
<div id="buffer-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="buffer-quiz-1-message_container" class="shiny-html-output"></div>
<div id="buffer-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="buffer-quiz-2" class="tutorial-question panel-body">
<div id="buffer-quiz-2-answer_container" class="shiny-html-output"></div>
<div id="buffer-quiz-2-message_container" class="shiny-html-output"></div>
<div id="buffer-quiz-2-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
</section>
<section id="conclusions" class="level3">
<h3 class="anchored" data-anchor-id="conclusions">Conclusions</h3>
<p>We now completed our power analysis. We have made the following assumptions:</p>
<ul>
<li>The prevalence of <em>dhps</em> A437G mutations in Pemba is 20% or higher.</li>
<li>We will compare against a threshold of 5% using a one-sample z-test.</li>
<li>We will recruit 105 participants, of which we expect 60% to be malaria positive.</li>
<li>We expect 10% loss of samples, leading to 57 successfully sequenced samples.</li>
</ul>
<p>Under these assumptions, we have calculated that we will have <strong>80% power</strong> to reject the null hypothesis.</p>
<p>If any of these assumptions are violated then our power analysis will no longer hold. For example, if we were to switch to a different statistical test then our sample size <em>may</em> no longer be sufficient. If we are not confident that the prevalence in Pemba will be at least 20% then similarly we should revisit this assumption and change the design.</p>
<p>Remember - it is a <strong>false economy</strong> to be optimistic when conducting power analysis (for example assuming a very large effect size) because we are likely to end up with non-significant results.</p>
<p>In the next section we will perform a similar analysis focused on <em>detection</em> of rare <em>pfk13</em> mutations.</p>
</section>
</section>
<section id="detecting-rare-variants" class="level2">
<h2 class="anchored" data-anchor-id="detecting-rare-variants">Detecting rare variants</h2>
<section id="background-1" class="level3">
<h3 class="anchored" data-anchor-id="background-1">Background</h3>
<p>Building on the success of your A437G study in Pemba, you have been invited to conduct a new study focused on identifying <em>pfk13</em> mutations in the neighbouring city of Nampula. This study will target WHO validated mutations that are known to be associated with partial resistance to artemisinin. Instead of estimating the <em>prevalence</em> of these mutations, your goal is simply to determine whether any of these mutations are <em>present</em> in the population.</p>
<p>Your plan is to test individuals who present with malaria symptoms at a local health facility. For those who test positive for malaria, dried blood spots will be collected and subsequently sent for sequencing. However, due to limited resources, you are only able to sequence 100 samples.</p>
<p>Your question: <strong>with a sample size of only 100, is it worthwhile to pursue this study?</strong></p>
</section>
<section id="framing-the-problem-as-a-hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="framing-the-problem-as-a-hypothesis-test">Framing the problem as a hypothesis test</h3>
<p>This type of detection study can be framed as a null hypothesis test.</p>
<p>Null hypothesis: <strong>The prevalence of the mutation(s) is 0%</strong>. In other words, it is completely absent from the population.</p>
<p>Even a single observation of a WHO-validated mutant would disprove this null hypothesis. Therefore, unlike most statistical tests, there is no test statistic to calculate here. Instead, we simply reject the null hypothesis if we see a single sample containing a WHO-validated mutant.</p>
<p>It is straightforward to calculate power under this test. As before, the steps of this derivation are hidden, but click the button below if you want to see them.</p>
<hr>
<details>
<summary style="
  background-color:#888888;
  color:white;
  padding:2px 4px;
  border-radius:4px;
  display:inline-block;
  cursor:pointer;
">
Show full derivation ▼
</summary>
<p><strong>Step 1: Chance of a single negative result:</strong></p>
<p>The probability that a single sample is negative (i.e.&nbsp;does not carry a validated <em>pfk13</em> mutation) is given by: <span class="math display">\[
\text{Pr}(\text{Negative}) = 1 - p
\]</span></p>
<p><strong>Step 2: Chance of <span class="math inline">\(n\)</span> negative results:</strong></p>
<p>The probability that all <span class="math inline">\(n\)</span> samples are negative is the probability of one negative sample raised to the power <span class="math inline">\(n\)</span>: <span class="math display">\[
\text{Pr}(n \text{ negatives}) = (1 - p)^n
\]</span> This assumes that samples are drawn independently from a much larger population.</p>
<p><strong>Step 3: Chance of at least one positive result:</strong></p>
<p>The chance of seeing at least one positive sample is equal to one minus the probability of seeing no positive samples. If we see a positive sample then we reject the null hypothesis. Hence, this is also our power:</p>
<p><span class="math display">\[
\text{Power} = 1 - (1 - p)^n
\]</span></p>
</details>
<hr>
<p>The resulting formula is: <span class="math display">\[
\text{Power} = 1 - (1 - p)^n
\]</span></p>
<p>This very simple expression can be used to guide our study design.</p>
<p>Complete the following R code to implement this formula. What is our power if we assume a true prevalence of 5%?</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="detection-1" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define parameters</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="detection-1-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define parameters</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate power</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>n</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(\text{Power} = 0.994\)</span> if we assume a prevalence of <span class="math inline">\(p = 0.05\)</span>.</p>
</details>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div class="panel-heading tutorial-quiz-title">QUIZ - Interpreting power</div>
</div>
<div class="cell-output-display no-overflow-x">
<div class="panel panel-default tutorial-question-container">
<div data-label="presence-power-quiz-1" class="tutorial-question panel-body">
<div id="presence-power-quiz-1-answer_container" class="shiny-html-output"></div>
<div id="presence-power-quiz-1-message_container" class="shiny-html-output"></div>
<div id="presence-power-quiz-1-action_button_container" class="shiny-html-output"></div>
<script>if (Tutorial.triggerMathJax) Tutorial.triggerMathJax()</script>
</div>
</div>
</div>
</div>
<p>Based on this result, we are over-powered to detect <em>pfk13</em> mutants. This gives us the freedom to reduce the sample size. So, how many samples are needed? Rearranging our power formula in terms of <span class="math inline">\(n\)</span> we obtain: <span class="math display">\[
n = \frac{\text{log}(1 - \text{Power})}{\text{log}(1 - p)}
\]</span></p>
<p>Complete the following R code to implement this sample size formula. What minimum sample size is needed if we assume a prevalence of 5% and are aiming for 80% power?</p>
<div class="cell" data-exercise="true">
<div class="tutorial-exercise" data-label="detection-2" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define prevalence</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minimum sample size</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":false,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
</div>
<div class="cell">
<div class="tutorial-exercise-support" data-label="detection-2-solution" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0" data-pipe="|>">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define prevalence</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minimum sample size</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.8</span>) <span class="sc">/</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> p)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<details>
<summary style="text-decoration: underline; color: red;">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"></path></svg>Click to see the answer
</summary>
<p>You should find that <span class="math inline">\(n = 31.38\)</span>, which would be rounded up to <span class="math inline">\(n = 32\)</span>.</p>
</details>
<p><br></p>
<p>This is a very promising result - we can definitely run a well-powered study within our resource constraints! However, we did make the fairly pessimistic assumption that validated <em>pfk13</em> mutants are at 5% prevalence in the population. In reality, we may want to catch them before they reach 5% in order to take pre-emptive measures. As before, we can consult a sample size table (<strong>Table 2</strong>):</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Assumed prevalence of pfk13 mutations</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sample size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 5cm;">0.1%</td>
<td style="text-align: right; width: 4cm;">1609</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 5cm;">0.5%</td>
<td style="text-align: right; width: 4cm;">322</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 5cm;">1%</td>
<td style="text-align: right; width: 4cm;">161</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 5cm;">2%</td>
<td style="text-align: right; width: 4cm;">80</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 5cm;">3%</td>
<td style="text-align: right; width: 4cm;">53</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 5cm;">4%</td>
<td style="text-align: right; width: 4cm;">40</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 5cm;">5%</td>
<td style="text-align: right; width: 4cm;">32</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup><br>
Table 2: minimum sample sizes needed to achieve 80% power under various assumptions about pfk13 mutation prevalence</td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
<div style="padding: 10px; border-radius: 5px; background-color: #fef3e7;">
<p><span style="font-size: 1.2em; color: #d19554;"> <i class="fas fa-comment"></i> Reflection: </span></p>
<p><span style="color:#d19554;"> Based on the values in <strong>Table 2</strong>, do you think it is worthwhile to conduct this study? If you ran a study that was powered down to 2% prevalence (80 samples) and did not find any <em>pfk13</em> mutants, would you be reassured by this result? </span></p>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(shiny)
knitr::opts_chunk$set(warning = FALSE,
                      echo = FALSE)

# needed for longer calculations (eg DRpower) note - in seconds
tutorial_options(exercise.timelimit = 120)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::prepare_tutorial_state(session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::i18n_observe_tutorial_language(input, session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-choose-test-1", 
    question = structure("From the formula for the z-statistic, what do we expect will happen if we increase the sample size?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_caa51", 
        option = "We will get less significant results because large samples make small effects harder to detect.", 
        value = "We will get less significant results because large samples make small effects harder to detect.", 
        label = structure("We will get less significant results because large samples make small effects harder to detect.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = structure("Larger samples actually make small effects easier to detect by reducing variability.", html = TRUE, class = c("html", 
        "character")), type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_398fed0", 
        option = "Increasing the sample size will have no effect on whether we reject the null hypothesis.", 
        value = "Increasing the sample size will have no effect on whether we reject the null hypothesis.", 
        label = structure("Increasing the sample size will have no effect on whether we reject the null hypothesis.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = structure("Power depends strongly on sample size: larger n → smaller standard error → higher power.", html = TRUE, class = c("html", 
        "character")), type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_4729bd2", 
        option = "We will tend to see larger values of z and more significant p-values, increasing the chance that we will reject the null hypothesis.", 
        value = "We will tend to see larger values of z and more significant p-values, increasing the chance that we will reject the null hypothesis.", 
        label = structure("We will tend to see larger values of z and more significant p-values, increasing the chance that we will reject the null hypothesis.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = structure("Large sample sizes increase the chance of correctly rejecting the null hypothesis", html = TRUE, class = c("html", 
        "character")), type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_e491331", 
        option = "The test becomes invalid if the sample size is too large.", 
        value = "The test becomes invalid if the sample size is too large.", 
        label = structure("The test becomes invalid if the sample size is too large.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = structure("Large samples don’t invalidate the test; they typically improve precision and power.", html = TRUE, class = c("html", 
        "character")), type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-choose-test-1-answer", question = "quiz-choose-test-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1052351433.00996, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$normalPlot <- renderPlot({
  
  # extract slider values
  p_true <- input$p_true / 100
  p_thresh <- input$p_thresh / 100
  n <- input$n
  m <- (p_true - p_thresh) / sqrt(p_true*(1 - p_true) / n)
  
  # other constants
  z_crit <- qnorm(0.975)
  pow <- pnorm(z_crit, mean = m, lower.tail = FALSE) + pnorm(-z_crit, mean = m, lower.tail = TRUE)
  
  # make plotting data
  df_plot <- data.frame(x = seq(-8, 8, by = 0.01)) |>
    mutate(H0 = dnorm(x),
           H1 = dnorm(x, mean = m))
  
  # plot
  df_plot |>
    ggplot() + theme_bw() +
    annotate(x = 0, y = 0.45, geom = "text", label = "Null", size = 7, col = "grey70") +
    geom_segment(x = 0, xend = 0, y = 0.42, yend = dnorm(0), colour = "grey70") +
    annotate(x = m, y = 0.5, geom = "text", label = "Alternative", size = 7, col = "grey70") +
    geom_segment(x = m, xend = m, y = 0.48, yend = dnorm(0), colour = "grey70") +
    geom_line(aes(x = x, y = H0)) +
    geom_area(aes(x = x, y = H0), data = subset(df_plot, x >=  z_crit), fill = "grey50", alpha = 0.5) +
    geom_area(aes(x = x, y = H0), data = subset(df_plot, x <=  -z_crit), fill = "grey50", alpha = 0.5) +
    geom_line(aes(x = x, y = H1)) +
    geom_area(aes(x = x, y = H1), data = subset(df_plot, x >=  z_crit), fill = "firebrick1", alpha = 0.5) +
    geom_area(aes(x = x, y = H1), data = subset(df_plot, x <=  -z_crit), fill = "firebrick1", alpha = 0.5) +
    scale_y_continuous(limits = c(0, 0.55), expand = c(0, 0)) +
    scale_x_continuous(limits = c(-8, 8), expand = c(0, 0)) +
    ggtitle(sprintf("Power = %s%%", round(pow*100, 1))) +
    theme(plot.title = element_text(colour = "firebrick1", size = 18, face = "bold")
)
  
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "quiz-alternative-test-1", 
    question = structure("What power would you expect if you assume the true prevalence is 20% (compared against the 5% threshold) and your sample size is 100?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_505e2b4", 
        option = "30.3%", value = "30.3%", label = structure("30.3%", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_a742f98", 
        option = "96.3%", value = "96.3%", label = structure("96.3%", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_fcd15ba", 
        option = "42.0%", value = "42.0%", label = structure("42.0%", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_769ff34", 
        option = "80.0%", value = "80.0%", label = structure("80.0%", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-alternative-test-1-answer", question = "quiz-alternative-test-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1648205991.73249, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_checkbox", label = "quiz-alternative-test-2", 
    question = structure("Power is highest when…(check all that apply)", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_be7ca68", 
        option = "The sample size is large", value = "The sample size is large", 
        label = structure("The sample size is large", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_4d9210", 
        option = "The true prevalence exactly equals the threshold", 
        value = "The true prevalence exactly equals the threshold", 
        label = structure("The true prevalence exactly equals the threshold", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_be6c094", 
        option = "The sample size is small", value = "The sample size is small", 
        label = structure("The sample size is small", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_3fe1e51", 
        option = "The true prevalence is a long way from the threshold", 
        value = "The true prevalence is a long way from the threshold", 
        label = structure("The true prevalence is a long way from the threshold", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Correct!", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect. Be sure to select every correct answer.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "quiz-alternative-test-2-answer", question = "quiz-alternative-test-2"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1387185089.85404, options = list()), class = c("learnr_checkbox", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ztest-1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ztest-1-code-editor`)), session)
output$`tutorial-exercise-ztest-1-output` <- renderUI({
  `tutorial-exercise-ztest-1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "ztest-1", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "library(shiny)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "ztest-1", code = "# input parameters\np0 <- ?\np <- ?\nn <- ?\n\n# calculate absolute value of difference in prevalence\np_diff <- abs(p - p0)\n\n# calculate the standard error\nSE <- sqrt(p*(1 - p) / n)\n\n# calculate the expected value of the statistic\nE_Z <- ?\n\nprint(E_Z)", 
        opts = list(label = "\"ztest-1\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# input parameters", 
    "p0 <- 0.05", "p <- 0.20", "n <- 100", "", "# calculate absolute value of difference in prevalence", 
    "p_diff <- abs(p - p0)", "", "# calculate the standard error", 
    "SE <- sqrt(p*(1 - p) / n)", "", "# calculate the expected value of the statistic", 
    "E_Z <- p_diff / SE", "", "print(E_Z)"), chunk_opts = list(
        label = "ztest-1-solution")), tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "activity4_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity4_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fig.asp = NULL, fenced.echo = FALSE, ft.shadow = FALSE, 
        exercise.timelimit = 120, label = "ztest-1", exercise = TRUE, 
        original.params.src = "r ztest-1, exercise=TRUE", chunk.echo = FALSE, 
        code = c("# input parameters", "p0 <- ?", "p <- ?", "n <- ?", 
        "", "# calculate absolute value of difference in prevalence", 
        "p_diff <- abs(p - p0)", "", "# calculate the standard error", 
        "SE <- sqrt(p*(1 - p) / n)", "", "# calculate the expected value of the statistic", 
        "E_Z <- ?", "", "print(E_Z)"), out.width.px = 672L, out.height.px = 480L, 
        params.src = "r ztest-1, exercise=TRUE", fig.num = 0, 
        exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ztest-2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ztest-2-code-editor`)), session)
output$`tutorial-exercise-ztest-2-output` <- renderUI({
  `tutorial-exercise-ztest-2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "ztest-2", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "library(shiny)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "ztest-2", code = "# calculate power\nE_Z <- 3.75\nz_alpha <- 1.96\npower <- ?   # hint, you will need to use the pnorm() function here\n\nprint(power)", 
        opts = list(label = "\"ztest-2\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# calculate power", 
    "E_Z <- 3.75", "z_alpha <- 1.96", "power <- 1 - pnorm(z_alpha - E_Z)", 
    "", "print(power)"), chunk_opts = list(label = "ztest-2-solution")), 
    tests = NULL, options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "activity4_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity4_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fig.asp = NULL, fenced.echo = FALSE, ft.shadow = FALSE, 
        exercise.timelimit = 120, label = "ztest-2", exercise = TRUE, 
        original.params.src = "r ztest-2, exercise=TRUE", chunk.echo = FALSE, 
        code = c("# calculate power", "E_Z <- 3.75", "z_alpha <- 1.96", 
        "power <- ?   # hint, you will need to use the pnorm() function here", 
        "", "print(power)"), out.width.px = 672L, out.height.px = 480L, 
        params.src = "r ztest-2, exercise=TRUE", fig.num = 0, 
        exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "power-quiz-1", 
    question = structure("A power of 96% means…", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_8ddd361", 
        option = "There is a 96% chance that the study will be successful.", 
        value = "There is a 96% chance that the study will be successful.", 
        label = structure("There is a 96% chance that the study will be successful.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_7b01945", 
        option = "There is a 96% difference in prevalence between the time points.", 
        value = "There is a 96% difference in prevalence between the time points.", 
        label = structure("There is a 96% difference in prevalence between the time points.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_f4b3e96", 
        option = "There is a 96% chance that the alternative hypothesis is true.", 
        value = "There is a 96% chance that the alternative hypothesis is true.", 
        label = structure("There is a 96% chance that the alternative hypothesis is true.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_cd9c19", 
        option = "Assuming the alternative hypothesis is true, there is a 96% chance that we will correctly reject the null hypothesis.", 
        value = "Assuming the alternative hypothesis is true, there is a 96% chance that we will correctly reject the null hypothesis.", 
        label = structure("Assuming the alternative hypothesis is true, there is a 96% chance that we will correctly reject the null hypothesis.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("That is correct! Under the current study design there is a 96% chance that we will correctly conclude that prevalence is above the 5% threshold.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: power is the chance of correctly rejecting the null hypothesis.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: power is the chance of correctly rejecting the null hypothesis.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "power-quiz-1-answer", question = "power-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1385859770.35466, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "power-curve-quiz-1", 
    question = structure("From this graph, what is the minimum sample size needed to achieve 80% power?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_67425d9", 
        option = "30", value = "30", label = structure("30", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_e09df5c", 
        option = "56", value = "56", label = structure("56", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_15969a7", 
        option = "80", value = "80", label = structure("80", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_1d8d191", 
        option = "More than 150", value = "More than 150", label = structure("More than 150", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("That is correct! Our planned sample size of 100 is almost double what we need to achieve 80% power.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: look for the point at which the curve intersects the shaded region.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: look for the point at which the curve intersects the shaded region.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "power-curve-quiz-1-answer", question = "power-curve-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1142517004.96797, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ztest-ss-2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ztest-ss-2-code-editor`)), session)
output$`tutorial-exercise-ztest-ss-2-output` <- renderUI({
  `tutorial-exercise-ztest-ss-2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "ztest-ss-2", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "library(shiny)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "ztest-ss-2", code = "# define our assumed values\np0 <- 0.05\np <- 0.15\n\n# define the two z parameters\nz_alpha <- 1.96\nz_beta <- qnorm(0.8)\n\n# calculate the minimum sample size\n(z_alpha + z_beta)^2 * p*(1 - p) / (p - p0)^2", 
        opts = list(label = "\"ztest-ss-2\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = NULL, tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "activity4_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity4_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fig.asp = NULL, fenced.echo = FALSE, ft.shadow = FALSE, 
        exercise.timelimit = 120, label = "ztest-ss-2", exercise = TRUE, 
        original.params.src = "r ztest-ss-2, exercise=TRUE", 
        chunk.echo = FALSE, code = c("# define our assumed values", 
        "p0 <- 0.05", "p <- 0.15", "", "# define the two z parameters", 
        "z_alpha <- 1.96", "z_beta <- qnorm(0.8)", "", "# calculate the minimum sample size", 
        "(z_alpha + z_beta)^2 * p*(1 - p) / (p - p0)^2"), out.width.px = 672L, 
        out.height.px = 480L, params.src = "r ztest-ss-2, exercise=TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "sample_size-quiz-1", 
    question = structure("What happens to the minimum sample size as you increase \\(p\\)?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_8f9bf63", 
        option = "It decreases", value = "It decreases", label = structure("It decreases", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_8c8ca5f", 
        option = "It stays the same", value = "It stays the same", 
        label = structure("It stays the same", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_834cab1", 
        option = "It increases", value = "It increases", label = structure("It increases", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("If the assumed true prevalence is further from the threshold we need fewer samples to prove this difference.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: try changing the parameter \\(p\\) in the code above and see what effect this has on the result.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: try changing the parameter \\(p\\) in the code above and see what effect this has on the result.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "sample_size-quiz-1-answer", question = "sample_size-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1064195071.00445, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "sample_size-quiz-2", 
    question = structure("When \\(p = 0.15\\) and \\(p_0 = 0.05\\) we obtain a minimum sample size of 100.0758. In practice we would…", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_f424f09", 
        option = "Round this down to 100", value = "Round this down to 100", 
        label = structure("Round this down to 100", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_7933c96", 
        option = "Round this up to 101", value = "Round this up to 101", 
        label = structure("Round this up to 101", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_d55bfc2", 
        option = "Change our assumptions until we hit a nice round number", 
        value = "Change our assumptions until we hit a nice round number", 
        label = structure("Change our assumptions until we hit a nice round number", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("By always rounding sample sizes <em>up<\u002fem> we ensure our results are conservative.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: we want our study to have power of <em>at least<\u002fem> 80%.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: we want our study to have power of <em>at least<\u002fem> 80%.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "sample_size-quiz-2-answer", question = "sample_size-quiz-2"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1243403627.421, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "sample_table-quiz-1", 
    question = structure("If our analysis reveals that we need 4427 samples we should…", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_332b19a", 
        option = "Fire our statistician, and try to recruit a new one who gives lower numbers.", 
        value = "Fire our statistician, and try to recruit a new one who gives lower numbers.", 
        label = structure("Fire our statistician, and try to recruit a new one who gives lower numbers.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_431e96e", 
        option = "Go ahead with 4427 samples, no matter what the consequences.", 
        value = "Go ahead with 4427 samples, no matter what the consequences.", 
        label = structure("Go ahead with 4427 samples, no matter what the consequences.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_59c2de6", 
        option = "Ignore the power analysis. Just collect whatever is feasible.", 
        value = "Ignore the power analysis. Just collect whatever is feasible.", 
        label = structure("Ignore the power analysis. Just collect whatever is feasible.", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_8f412a9", 
        option = "Assess the feasibility of this sample size, and consider other designs or assumptions that might give more feasible numbers.", 
        value = "Assess the feasibility of this sample size, and consider other designs or assumptions that might give more feasible numbers.", 
        label = structure("Assess the feasibility of this sample size, and consider other designs or assumptions that might give more feasible numbers.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("Statistical power is just one aspect of study optimisation, and should be taken alongside other considerations.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Incorrect", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "sample_table-quiz-1-answer", question = "sample_table-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 807769972.623853, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_checkbox", label = "sample_table-quiz-2", 
    question = structure("What other factors could play a part when deciding whether or not to run this study?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_802a16e", 
        option = "Logistics of sample collection.", value = "Logistics of sample collection.", 
        label = structure("Logistics of sample collection.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_3698451", 
        option = "Costs of raw materials and staff time.", value = "Costs of raw materials and staff time.", 
        label = structure("Costs of raw materials and staff time.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_75ad363", 
        option = "The time required to run the study and produce results.", 
        value = "The time required to run the study and produce results.", 
        label = structure("The time required to run the study and produce results.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_5b678e9", 
        option = "The ethics of taking blood from this many people.", 
        value = "The ethics of taking blood from this many people.", 
        label = structure("The ethics of taking blood from this many people.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_63ca5f6", 
        option = "The opportunity cost of running this study, i.e. how many other different studies could be run for the same cost.", 
        value = "The opportunity cost of running this study, i.e. how many other different studies could be run for the same cost.", 
        label = structure("The opportunity cost of running this study, i.e. how many other different studies could be run for the same cost.", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_7bf2b4c", 
        option = "How much we really need an answer to this particular question", 
        value = "How much we really need an answer to this particular question", 
        label = structure("How much we really need an answer to this particular question", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("<strong>All<\u002fstrong> of these factors play a role in our decision making.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Incorrect. Be sure to select every correct answer.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("There are still more aspects to consider…", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "sample_table-quiz-2-answer", question = "sample_table-quiz-2"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 957531044.054115, options = list()), class = c("learnr_checkbox", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "buffer-quiz-1", 
    question = structure("Assuming 10% of samples will be lost, how many malaria positive samples should we aim to collect?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_c4e1560", 
        option = "60", value = "60", label = structure("60", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_beeea5f", 
        option = "61", value = "61", label = structure("61", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_b77bb03", 
        option = "62", value = "62", label = structure("62", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_1e33a2f", 
        option = "63", value = "63", label = structure("63", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("10% of 63 samples is around 7, resulting in the target 56.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: divide by 0.9 and round up.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: divide by 0.9 and round up.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "buffer-quiz-1-answer", question = "buffer-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 150890566.429736, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "buffer-quiz-2", 
    question = structure("Use your answer from the previous question to work out how many patients we need to enrol that have suspected malaria. Assume a 60% positivity rate", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_e66d888", 
        option = "100", value = "100", label = structure("100", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_7ddb117", 
        option = "105", value = "105", label = structure("105", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_a09c468", 
        option = "110", value = "110", label = structure("110", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_ddcb86e", 
        option = "115", value = "115", label = structure("115", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("60% of 105 samples leaves us with 63 expected positive cases.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: use the same inflation formula as in the previous question.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: use the same inflation formula as in the previous question.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "buffer-quiz-2-answer", question = "buffer-quiz-2"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 1983319843.07644, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-detection-1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-detection-1-code-editor`)), session)
output$`tutorial-exercise-detection-1-output` <- renderUI({
  `tutorial-exercise-detection-1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "detection-1", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "library(shiny)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "detection-1", code = "# define parameters\np <- \nn <- \n\n# calculate power\npower <- \n\nprint(power)", 
        opts = list(label = "\"detection-1\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# define parameters", 
    "p <- 0.05", "n <- 100", "", "# calculate power", "power <- 1 - (1 - p)^n", 
    "", "print(power)"), chunk_opts = list(label = "detection-1-solution")), 
    tests = NULL, options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "activity4_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity4_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fig.asp = NULL, fenced.echo = FALSE, ft.shadow = FALSE, 
        exercise.timelimit = 120, label = "detection-1", exercise = TRUE, 
        original.params.src = "r detection-1, exercise=TRUE", 
        chunk.echo = FALSE, code = c("# define parameters", "p <- ", 
        "n <- ", "", "# calculate power", "power <- ", "", "print(power)"
        ), out.width.px = 672L, out.height.px = 480L, params.src = "r detection-1, exercise=TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::question_prerendered_chunk(structure(list(type = "learnr_radio", label = "presence-power-quiz-1", 
    question = structure("Based on this result, which of these statements is correct?", html = TRUE, class = c("html", 
    "character")), answers = list(structure(list(id = "lnr_ans_e25dcdd", 
        option = "We have insufficient power under the current design", 
        value = "We have insufficient power under the current design", 
        label = structure("We have insufficient power under the current design", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_b5dbb07", 
        option = "We have adequate power under the current design", 
        value = "We have adequate power under the current design", 
        label = structure("We have adequate power under the current design", html = TRUE, class = c("html", 
        "character")), correct = FALSE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer")), structure(list(id = "lnr_ans_f52fed2", 
        option = "We are over-powered under the current design", 
        value = "We are over-powered under the current design", 
        label = structure("We are over-powered under the current design", html = TRUE, class = c("html", 
        "character")), correct = TRUE, message = NULL, type = "literal"), class = c("tutorial_question_answer", 
    "tutorial_quiz_answer"))), button_labels = list(submit = structure("<span data-i18n=\"button.questionsubmit\">Submit Answer<\u002fspan>", html = TRUE, class = c("html", 
    "character")), try_again = structure("<span data-i18n=\"button.questiontryagain\">Try Again<\u002fspan>", html = TRUE, class = c("html", 
    "character"))), messages = list(correct = structure("That is correct! We typically aim for at least 80% power, and we are way over this limit at 99.4% power.", html = TRUE, class = c("html", 
    "character")), try_again = structure("Hint: Remember what power we normally aim for in definitive (non-pilot) studies.", html = TRUE, class = c("html", 
    "character")), incorrect = structure("Hint: Remember what power we normally aim for in definitive (non-pilot) studies.", html = TRUE, class = c("html", 
    "character")), message = NULL, post_message = NULL), ids = list(
        answer = "presence-power-quiz-1-answer", question = "presence-power-quiz-1"), 
    loading = NULL, random_answer_order = FALSE, allow_retry = TRUE, 
    seed = 425989763.801633, options = list()), class = c("learnr_radio", 
"tutorial_question")), session = session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-detection-2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-detection-2-code-editor`)), session)
output$`tutorial-exercise-detection-2-output` <- renderUI({
  `tutorial-exercise-detection-2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "detection-2", global_setup = structure(c("library(learnr)", 
"library(dplyr)", "library(tidyr)", "library(ggplot2)", "library(knitr)", 
"library(kableExtra)", "library(shiny)", "knitr::opts_chunk$set(warning = FALSE,", 
"                      echo = FALSE)", "", "# needed for longer calculations (eg DRpower) note - in seconds", 
"tutorial_options(exercise.timelimit = 120)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "detection-2", code = "# define prevalence\np <- \n\n# calculate minimum sample size\nn <- \n\nprint(n)", 
        opts = list(label = "\"detection-2\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = NULL, solution = structure(c("# define prevalence", 
    "p <- 0.05", "", "# calculate minimum sample size", "n <- log(1 - 0.8) / log(1 - p)", 
    "", "print(n)"), chunk_opts = list(label = "detection-2-solution")), 
    tests = NULL, options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "activity4_power_interactive_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "activity4_power_interactive_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 7L, fig.height = 5L, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 672L, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = FALSE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        fig.asp = NULL, fenced.echo = FALSE, ft.shadow = FALSE, 
        exercise.timelimit = 120, label = "detection-2", exercise = TRUE, 
        original.params.src = "r detection-2, exercise=TRUE", 
        chunk.echo = FALSE, code = c("# define prevalence", "p <- ", 
        "", "# calculate minimum sample size", "n <- ", "", "print(n)"
        ), out.width.px = 672L, out.height.px = 480L, params.src = "r detection-2, exercise=TRUE", 
        fig.num = 0, exercise.df_print = "default", exercise.checker = "NULL"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(
    function(q, nm, val) {
      # Infer name, if possible
      if (nm == "") {
        tryCatch(
          {
            nm <- rlang::as_name(q)
          },
          error = function(e) {
            code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
            stop(
              "ojs_define() could not create a name for the argument: ",
              code
            )
          }
        )
      }
      .session$output[[nm]] <- val
      outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
      .session$sendCustomMessage("ojs-export", list(name = nm))
      NULL
    },
    quos,
    nm,
    vars,
    SIMPLIFY = FALSE,
    USE.NAMES = FALSE
  )
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["5.5.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["htmltools-fill"]},{"type":"character","attributes":{},"value":["0.5.8.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fill"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fill.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["htmltools"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.8.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.4.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","accessibility/js/bootstrap-accessibility.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css","accessibility/css/bootstrap-accessibility.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.8.1.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.4.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.4.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.5"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["kePrint"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["kePrint-0.0.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["kePrint.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.4.0"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["lightable"]},{"type":"character","attributes":{},"value":["0.0.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lightable-0.0.1"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["lightable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["kableExtra"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.4.0"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71]}},"value":[{"type":"character","attributes":{},"value":["backports","base","bslib","cachem","checkmate","cli","commonmark","compiler","datasets","dichromat","digest","dplyr","ellipsis","evaluate","farver","fastmap","fontawesome","generics","ggplot2","glue","graphics","grDevices","grid","gtable","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","kableExtra","knitr","later","learnr","lifecycle","magrittr","markdown","memoise","methods","mime","pillar","pkgconfig","promises","purrr","R6","RColorBrewer","Rcpp","rlang","rmarkdown","rprojroot","rstudioapi","S7","sass","scales","shiny","stats","stringi","stringr","svglite","systemfonts","tibble","tidyr","tidyselect","tools","utils","vctrs","viridisLite","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.5.0","4.4.0","0.7.0","1.1.0","2.3.1","3.6.5","1.9.1","4.4.0","4.4.0","2.0-0.1","0.6.37","1.1.4","0.3.2","0.24.0","2.1.2","1.2.0","0.5.2","0.1.4","4.0.0","1.8.0","4.4.0","4.4.0","4.4.0","0.3.6","0.5.8.1","1.6.4","1.6.15","0.1.4","2.0.0","1.4.0","1.47","1.3.2","0.11.5","1.0.4","2.0.4","1.13","2.0.1","4.4.0","0.12","1.11.1","2.0.3","1.3.0","1.1.0","2.6.1","1.1-3","1.0.13","1.1.6","2.27","2.1.1","0.16.0","0.2.0","0.4.9","1.4.0","1.8.1.1","4.4.0","1.8.7","1.5.2","2.1.3","1.1.0","3.3.0","1.3.1","1.2.1","4.4.0","4.4.0","0.6.5","0.4.2","3.0.2","0.45","1.3.6","1.8-4","2.3.9"]}]}]}
</script>
<!--/html_preserve-->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>